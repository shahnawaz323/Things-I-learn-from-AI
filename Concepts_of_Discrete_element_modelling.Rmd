
title: "Concepts of Discrete element modelling"
author:
  - first_name: "shah"
    last_name: "nawaz"
    url: https://github.com/shahnawaz323
    affiliation: Universite Grenoble Alpes
    affiliation_url: https://3sr.univ-grenoble-alpes.fr/en/membre/shah-nawaz
    orcid_id: 0000-0002-0571-1827
citation_url: https://github.com/shahnawaz323/Things-I-learn-from-AI
date: "`r Sys.Date()`"
output:  
  distill::distill_article:
      toc: true
      toc_depth: 2
      code_folding: true


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Shah Nawaz**: what is discrete element modelling

**Raycast AI:** Discrete element modelling (DEM) is a computational technique used to simulate the behavior of granular materials, such as powders, grains, and particles, by modeling them as individual discrete elements that interact with each other through contact forces. It is commonly used in engineering and physics to study the behavior of granular materials in various applications, such as powder processing, soil mechanics, and geomechanics.

**Shah Nawaz**: what are other names of discrete element in other fields

**Raycast AI:** In other fields, discrete element modelling (DEM) may be referred to by different names. For example, in computer graphics and animation, a similar technique is known as particle systems. In molecular dynamics, a related approach is called molecular dynamics simulation. In fluid dynamics, a similar method is called smoothed particle hydrodynamics (SPH). The specific terminology used may vary depending on the field and the application.

**Shah Nawaz**: what is common in between discrete element and these techniques

**Raycast AI:** The common feature among discrete element modelling (DEM), particle systems, molecular dynamics simulation, and smoothed particle hydrodynamics (SPH) is that they all model a complex system by breaking it down into individual discrete elements or particles and simulating the interactions between them. These techniques are used in various fields to study the behavior of different types of systems, such as granular materials, fluids, and molecular systems. They are all based on numerical simulations that require solving equations of motion for each individual element or particle in the system, which can be computationally intensive.

**Shah Nawaz**: for instance describe difference between molecular dynamics and discrete element

**Raycast AI:** Molecular dynamics (MD) simulation and discrete element modelling (DEM) are both numerical techniques used to simulate the behavior of a large number of interacting particles. However, they differ in the type of particles they model and the forces they consider.

MD simulation is typically used to study the behavior of molecular systems, such as atoms and molecules. It models the particles as point masses that interact through interatomic or intermolecular forces, such as electrostatic, van der Waals, and covalent bonds. The motion of each particle is determined by solving Newton's equations of motion, taking into account the forces acting on it from all the other particles in the system.

On the other hand, DEM is typically used to study the behavior of granular materials, such as powders, grains, and particles. It models the particles as rigid or deformable bodies that interact through contact forces, such as friction, restitution, and adhesion. The motion of each particle is determined by solving the equations of motion for the translational and rotational degrees of freedom, taking into account the contact forces acting on it from all the other particles in the system.

In summary, while both MD simulation and DEM are based on the same general principle of simulating the behavior of interacting particles, they differ in the type of particles they model and the forces they consider. MD simulation models molecular systems using interatomic or intermolecular forces, while DEM models granular materials using contact forces.

**Shah Nawaz**: what is difference between linear dashpot model and contact dynamics model 
**Raycast AI:** The linear dashpot model and contact dynamics model are two different approaches to modeling the contact forces between particles in DEM simulations.
The linear dashpot model is a simple and widely used model that assumes that the contact force between two particles is proportional to their overlap and relative velocity, and is described by a linear spring and dashpot combination. The linear dashpot model is computationally efficient and easy to implement, but it has some limitations, such as the inability to capture the effects of frictional sliding and rolling resistance between particles.
In contrast, the contact dynamics model is a more advanced approach that explicitly models the dynamics of the contacts between particles, taking into account their deformation, frictional sliding, and rolling resistance. The contact dynamics model uses a time-stepping algorithm to solve the equations of motion for each particle and contact, and can accurately capture the complex behavior of granular materials under a wide range of loading conditions.
The main difference between the linear dashpot model and the contact dynamics model is the level of detail in the modeling of the contact forces. The linear dashpot model provides a simplified description of the contact forces based on a linear relationship between the overlap and relative velocity, while the contact dynamics model provides a more detailed and accurate description of the contact forces based on the physical properties of the particles and the contact surfaces.
Overall, the choice of contact force model depends on the specific requirements of the simulation, such as the level of accuracy needed, the computational resources available, and the complexity of the system being modeled. The linear dashpot model is a good choice for simple systems where the effects of frictional sliding and rolling resistance are negligible, while the contact dynamics model is a better choice for more complex systems where these effects are important

**Shah Nawaz** how damping works in discrete element modelling

Raycast AI: Damping in discrete element modeling is used to dissipate energy and control the numerical stability of the simulation. It is typically implemented through a damping coefficient that is applied to the relative velocity between particles or between particles and boundaries. The damping coefficient can be adjusted to control the amount of energy dissipation and to ensure that the simulation remains stable. Higher damping coefficients result in more energy dissipation and faster convergence, but can also lead to unrealistic behavior if overused.

**Shah Nawaz** what are popular damping methods in discrete element methods for granular materials

Raycast AI: The most commonly used damping methods in discrete element modeling for granular materials are linear and nonlinear damping. Linear damping is proportional to the relative velocity between particles and is typically used to dissipate energy due to collisions. Nonlinear damping, on the other hand, is proportional to the square of the relative velocity and is used to simulate other energy dissipation mechanisms such as friction and rolling resistance. Another popular damping method is viscous damping, which is proportional to the relative velocity and is used to simulate the effects of a surrounding fluid. In addition, contact damping, which is based on the deformation of the contact interface between particles, can also be used to dissipate energy and control the simulation stability.

**Shah Nawaz** show with equations

Raycast AI: Sure, here are the equations for the damping methods I mentioned in my previous answer:

Linear damping:
The force due to linear damping is proportional to the relative velocity between two particles i and j, with a damping coefficient c_d:

F_damping = -c_d * (v_i,j)

where v_i,j is the relative velocity between particles i and j.

Nonlinear damping:
The force due to nonlinear damping is proportional to the square of the relative velocity between two particles i and j, with a damping coefficient c_d:

F_damping = -c_d * (v_i,j)^2

Viscous damping:
The force due to viscous damping is proportional to the relative velocity between a particle and the surrounding fluid, with a damping coefficient c_d:

F_damping = -c_d * v

where v is the relative velocity between the particle and the fluid.

Contact damping:
The force due to contact damping is proportional to the deformation of the contact interface between two particles i and j, with a damping coefficient c_d:

F_damping = -c_d * delta_x_i,j

where delta_x_i,j is the displacement of the contact interface between particles i and j.

**Shah Nawaz** how damping is introduced in linear elastic model of dem

Raycast AI: In a linear elastic model of discrete element method (DEM), damping is introduced through a damping matrix, which is added to the stiffness matrix to account for energy dissipation. The damping matrix is typically proportional to the mass matrix and the damping coefficient, and it is used to model the damping effects due to inter-particle collisions and other energy dissipation mechanisms.

The equation of motion for a linear elastic DEM system with damping can be written as:

[M] {u''} + [C] {u'} + [K] {u} = {F}

where [M], [C], and [K] are the mass, damping, and stiffness matrices, respectively, {u} is the vector of particle displacements, {u'} and {u''} are the first and second derivatives of {u} with respect to time, and {F} is the vector of external forces acting on the particles.

The damping matrix [C] is typically proportional to the mass matrix [M] and the damping coefficient c_d, and it can be written as:

[C] = c_d [M]

where c_d is the damping coefficient. The damping force F_damping can then be calculated as:

F_damping = - [C] {u'}

where {u'} is the velocity vector of the particles.

By adding the damping matrix to the stiffness matrix, the equation of motion becomes a damped system that can be solved numerically to simulate the behavior of the DEM system with energy dissipation due to damping.

**Shah Nawaz** what does it mean that we need energy dissiapation in dem

Raycast AI: In a discrete element method (DEM) simulation, energy dissipation is necessary to account for the loss of kinetic energy during particle-particle and particle-boundary interactions. Without energy dissipation, the simulated system would be perfectly elastic, meaning that the particles would bounce off each other and the boundaries without losing any energy. This is not realistic, as real-world granular materials exhibit energy dissipation due to friction, inelastic collisions, and other mechanisms.

Energy dissipation in DEM simulations is typically introduced through damping, which can be modeled using various damping methods such as linear, nonlinear, or contact damping. These damping methods introduce forces that oppose the motion of the particles and dissipate energy, resulting in a more realistic simulation of the behavior of granular materials.

Energy dissipation is important in DEM simulations because it affects the overall behavior of the system. For example, if there is no energy dissipation, the particles in the system would continue to bounce around indefinitely, resulting in unrealistic behavior. Energy dissipation due to damping can help to stabilize the simulation and prevent this type of unrealistic behavior. In addition, energy dissipation can affect the stress-strain behavior of the material, as well as its flow properties and other characteristics.

**Shah Nawaz** what is choice of time step in discrete element method

Raycast AI: The choice of time step in discrete element method (DEM) simulations is important for obtaining accurate and stable results. The time step determines the duration of each simulation iteration, and it should be small enough to capture the dynamics of the system without being too computationally expensive.

The time step in DEM simulations is typically chosen based on the maximum allowable displacement of the particles during one time step, which is determined by the particle velocity and the size of the time step. The time step should be small enough to ensure that the particles do not move more than a fraction of their diameter during one time step, which can lead to inaccurate results and instability in the simulation.

The choice of time step also depends on the type of simulation being performed and the properties of the material being simulated. For example, simulations of highly dynamic systems with fast particle velocities may require smaller time steps to accurately capture the particle motion, while simulations of more static systems with slower particle velocities may be able to use larger time steps.

In general, the time step should be chosen such that the simulation is stable and accurate, while also being computationally efficient. A common approach is to perform a sensitivity analysis to determine the appropriate time step for a given simulation, by gradually decreasing the time step and observing the effect on the simulation results.

**Shah Nawaz** show with equations

Raycast AI: Sure, here is an equation that shows how the choice of time step in a discrete element method (DEM) simulation is related to the maximum allowable displacement of the particles:

Δt ≤ α * d_max / v_max

where Δt is the time step, d_max is the maximum particle diameter, v_max is the maximum particle velocity, and α is a safety factor that is typically set to a value between 0.1 and 0.5.

The maximum allowable displacement of the particles during one time step is given by:

Δx_max = v_max * Δt

To ensure that the particles do not move more than a fraction of their diameter during one time step, the time step should be small enough such that:

Δx_max ≤ d_max / n

where n is a safety factor that is typically set to a value between 5 and 10.

Combining these equations, we get:

v_max * Δt ≤ d_max / n

Δt ≤ d_max / (n * v_max)

Taking the safety factor α into account, we get:

Δt ≤ α * d_max / v_max

This equation shows that the time step should be chosen such that the maximum allowable displacement of the particles during one time step is smaller than a fraction of their diameter, which ensures that the simulation is accurate and stable. The choice of the safety factors α and n depends on the specific simulation being performed and the properties of the material being simulated.

**Shah Nawaz** explain concept of time step in detail for dem

Raycast AI: In discrete element method (DEM) simulations, the concept of time step refers to the duration of each simulation iteration. The time step determines how often the simulation is updated, and it is a crucial parameter that affects the accuracy, stability, and computational efficiency of the simulation.

During each time step, the forces acting on the particles are calculated based on their positions and velocities, and the particle positions and velocities are updated accordingly. The duration of the time step should be small enough to accurately capture the dynamics of the system, while also being large enough to avoid excessive computational cost.

The choice of time step in DEM simulations is typically based on the maximum allowable displacement of the particles during one time step. This maximum allowable displacement is determined by the particle velocity and the size of the time step, and it should be small enough to ensure that the particles do not move more than a fraction of their diameter during one time step. This is important to ensure that the simulation is accurate and stable, as well as to avoid excessive computational cost.

The time step is related to the particle velocity and the size of the time step through the Courant-Friedrichs-Lewy (CFL) stability criterion. This criterion states that the time step should be small enough such that the maximum allowable displacement of the particles during one time step is smaller than a fraction of their diameter. The specific value of this fraction depends on the properties of the material being simulated and the specific simulation being performed.

The choice of time step also depends on the type of simulation being performed and the properties of the material being simulated. For example, simulations of highly dynamic systems with fast particle velocities may require smaller time steps to accurately capture the particle motion, while simulations of more static systems with slower particle velocities may be able to use larger time steps.

In general, the time step should be chosen such that the simulation is stable and accurate, while also being computationally efficient. A common approach is to perform a sensitivity analysis to determine the appropriate time step for a given simulation, by gradually decreasing the time step and observing the effect on the simulation results.

**Shah Nawaz** how time steps is added into contact law of dem 

Raycast AI: In discrete element method (DEM) simulations, the contact law between particles is typically formulated in terms of forces and displacements, and the time step is incorporated through the calculation of the particle velocities and positions at each time step.

The contact law in DEM simulations typically includes a normal force and a tangential force, which are calculated based on the overlap and relative velocity between the particles. The normal force is typically modeled using a linear or nonlinear spring-dashpot system, while the tangential force is typically modeled using a friction law that includes a static friction coefficient and a dynamic friction coefficient.

To incorporate the time step into the contact law, the particle velocities and positions are updated at each time step based on the forces acting on the particles. The particle velocities are updated using the equation:

v_i(t+Δt) = v_i(t) + (F_i(t) + F_i(t+Δt)) / (2m_i) * Δt

where v_i(t) and v_i(t+Δt) are the velocities of particle i at times t and t+Δt, F_i(t) and F_i(t+Δt) are the forces acting on particle i at times t and t+Δt, m_i is the mass of particle i, and Δt is the time step.

The particle positions are updated using the equation:

x_i(t+Δt) = x_i(t) + v_i(t+Δt) * Δt

where x_i(t) and x_i(t+Δt) are the positions of particle i at times t and t+Δt, and Δt is the time step.

By updating the particle velocities and positions at each time step based on the forces acting on the particles, the time step is incorporated into the contact law of the DEM simulation, and the simulation can accurately capture the dynamics of the system over time.

**Shah Nawaz** what is role of 3 normal vectors in 3d dem in x, y and z direction

Raycast AI: In three-dimensional discrete element method (DEM) simulations, the role of the three normal vectors in the x, y, and z directions is to define the contact plane between two particles or between a particle and a boundary. These normal vectors are used to calculate the normal force between the particles or between the particle and the boundary, which is a key component of the contact law in DEM simulations.

The normal vectors in the x, y, and z directions are typically defined as the unit vectors along the x, y, and z axes, respectively. These vectors are perpendicular to the surfaces of the particles or boundaries, and they define the direction of the normal force acting between the contacting surfaces.

When two particles or a particle and a boundary come into contact, the normal vectors in the x, y, and z directions are used to calculate the overlap between the surfaces and the direction of the normal force. The overlap is calculated as the distance between the surfaces along the direction of the normal vector, and the normal force is calculated using a spring-dashpot system that is based on the overlap and the elastic properties of the particles or boundaries.

The normal vectors in the x, y, and z directions are also used to calculate the tangential force between the surfaces, which is important for modeling friction and other shear-related phenomena. The tangential force is calculated using a friction law that is based on the relative velocity between the surfaces and the direction of the tangential vector, which is perpendicular to the normal vector and lies in the plane of the contact surface.

Overall, the normal vectors in the x, y, and z directions play a critical role in defining the contact plane and calculating the normal and tangential forces between particles or between particles and boundaries in three-dimensional DEM simulations.

**Shah Nawaz** show with equations

Raycast AI: Sure, here are the equations that show how the normal vectors in the x, y, and z directions are used to calculate the normal force between two particles or between a particle and a boundary in three-dimensional discrete element method (DEM) simulations:

When two particles or a particle and a boundary come into contact, the overlap between the surfaces is calculated as the distance between the surfaces along the direction of the normal vector. The overlap is given by:

Δx = (r_i + r_j) - ||x_i - x_j||

where r_i and r_j are the radii of particles i and j, respectively, x_i and x_j are the positions of particles i and j, ||x_i - x_j|| is the distance between the particles, and Δx is the overlap.

The normal force between the particles or between the particle and the boundary is calculated using a spring-dashpot system that is based on the overlap and the elastic properties of the particles or boundaries. The normal force is given by:

F_n = k_n * Δx - γ_n * v_n

where k_n is the normal stiffness, γ_n is the normal damping coefficient, v_n is the relative velocity between the particles or between the particle and the boundary along the direction of the normal vector, and F_n is the normal force.

The normal vector in the x direction is given by:

n_x = [1, 0, 0]

The normal vector in the y direction is given by:

n_y = [0, 1, 0]

The normal vector in the z direction is given by:

n_z = [0, 0, 1]

These normal vectors are used to define the direction of the normal force acting between the contacting surfaces.

The tangential force between the surfaces is calculated using a friction law that is based on the relative velocity between the surfaces and the direction of the tangential vector, which is perpendicular to the normal vector and lies in the plane of the contact surface. The tangential force is given by:

F_t = min(F_s, μ * F_n) * v_t / ||v_t||

where F_s is the shear strength, μ is the coefficient of friction, F_n is the normal force, v_t is the relative velocity between the surfaces along the direction of the tangential vector, and F_t is the tangential force.

Overall, these equations show how the normal vectors in the x, y, and z directions are used to define the contact plane and calculate the normal and tangential forces between particles or between particles and boundaries in three-dimensional DEM simulations.

**Shah Nawaz** why we multiply damping coefficient with stiffness coefficient

Raycast AI: In discrete element method (DEM) simulations, the damping coefficient is multiplied with the stiffness coefficient to account for energy dissipation due to damping. This is because damping and stiffness are related through the equation of motion, and the combination of damping and stiffness determines the behavior of the system over time.

In DEM simulations, the equation of motion for a particle is typically written as:

m*d^2x/dt^2 = F - c*d(x)/dt - k*x

where m is the mass of the particle, x is the position of the particle, F is the force acting on the particle, c is the damping coefficient, and k is the stiffness coefficient.

The second term on the right-hand side of the equation represents the damping force, which is proportional to the velocity of the particle and the damping coefficient. The third term on the right-hand side of the equation represents the elastic force, which is proportional to the displacement of the particle and the stiffness coefficient.

The combination of damping and stiffness determines the behavior of the system over time. If the damping coefficient is too small, the system may exhibit excessive oscillations and instability. If the damping coefficient is too large, the system may exhibit excessive energy dissipation and unrealistic behavior. Similarly, if the stiffness coefficient is too small, the system may be too compliant and deform too much under load. If the stiffness coefficient is too large, the system may be too rigid and fail to deform under load.

By multiplying the damping coefficient with the stiffness coefficient, the relative importance of damping and stiffness can be adjusted to control the behavior of the system. This allows the simulation to accurately capture the dynamics of the system over time, while also ensuring that the system is stable and realistic.

**Shah Nawaz** explain some other energy dissipation methods in dem

Raycast AI: In addition to damping, there are several other energy dissipation methods that can be used in discrete element method (DEM) simulations to accurately model the behavior of granular materials. Some of the commonly used energy dissipation methods in DEM simulations are:

1. Rolling resistance: Rolling resistance is a type of frictional force that occurs when particles roll against each other. Rolling resistance can be modeled using a coefficient of rolling resistance, which is typically smaller than the coefficient of static or dynamic friction.

2. Plastic deformation: Plastic deformation occurs when particles deform permanently under load. Plastic deformation can be modeled using a plasticity model, which defines the relationship between stress and strain in the material.

3. Contact hysteresis: Contact hysteresis is a phenomenon where the contact force between particles depends on the history of the contact. Contact hysteresis can be modeled using a hysteretic spring-dashpot system, which includes a memory term that accounts for the history of the contact.

4. Viscous damping: Viscous damping is a type of damping that occurs when particles move through a viscous fluid. Viscous damping can be modeled using a damping coefficient that depends on the viscosity of the fluid and the relative velocity between the particles and the fluid.

5. Inelastic collisions: Inelastic collisions occur when particles collide and lose kinetic energy due to deformation or other energy dissipation mechanisms. Inelastic collisions can be modeled using a coefficient of restitution, which defines the ratio of the relative velocities before and after the collision.

These energy dissipation methods can be combined with damping to accurately model the behavior of granular materials in DEM simulations. The choice of energy dissipation method depends on the specific material being simulated and the type of simulation being performed.

**Shah Nawaz** show with equations

Raycast AI: Sure, here are some equations that show how some of the other energy dissipation methods can be incorporated into discrete element method (DEM) simulations:

1. Rolling resistance:

The rolling resistance force can be modeled using a coefficient of rolling resistance, μ_r, and the relative velocity between the particles, v_r. The rolling resistance force is given by:

F_r = -μ_r * F_n * v_r / ||v_r||

where F_n is the normal force and ||v_r|| is the magnitude of the relative velocity between the particles.

2. Plastic deformation:

Plastic deformation can be modeled using a plasticity model that defines the relationship between stress and strain in the material. One commonly used plasticity model is the Drucker-Prager model, which defines the yield stress, σ_y, and the hardening modulus, H. The plastic deformation is given by:

Δε_p = (σ - σ_y) / H

where Δε_p is the plastic strain, σ is the stress, and σ_y and H are material parameters.

3. Contact hysteresis:

Contact hysteresis can be modeled using a hysteretic spring-dashpot system that includes a memory term that accounts for the history of the contact. The hysteretic spring-dashpot system is given by:

F_n = k_n * Δx - γ_n * v_n - k_h * Δx_h

where k_n is the normal stiffness, γ_n is the normal damping coefficient, v_n is the relative velocity between the particles along the direction of the normal vector, Δx is the overlap between the particles, k_h is the hysteretic stiffness, and Δx_h is the history-dependent displacement.

4. Viscous damping:

Viscous damping can be modeled using a damping coefficient that depends on the viscosity of the fluid, η, and the relative velocity between the particles and the fluid, v_f. The viscous damping force is given by:

F_d = -6πηr*v_f

where r is the radius of the particle and v_f is the relative velocity between the particle and the fluid.

5. Inelastic collisions:

Inelastic collisions can be modeled using a coefficient of restitution, e, which defines the ratio of the relative velocities before and after the collision. The velocity of particle i after collision with particle j is given by:

v_i' = (m_i*v_i + m_j*v_j + (1-e)*m_j*(v_j - v_i)*n_ij) / (m_i + m_j)

where v_i and v_j are the velocities of particles i and j before the collision, n_ij is the normal vector between the particles, and v_i' is the velocity of particle i after the collision.

These equations show how some of the other energy dissipation methods can be incorporated into DEM simulations to accurately model the behavior of granular materials. The specific energy dissipation method used depends on the material being simulated and the type of simulation being performed.

**Shah Nawaz** is it necesary to add a dissipation method in each simulation of dem

Raycast AI: The choice of whether or not to include an energy dissipation method in a discrete element method (DEM) simulation depends on the specific material being simulated and the type of simulation being performed. In some cases, energy dissipation may be negligible, and the simulation can be accurately modeled without including an explicit energy dissipation method. In other cases, energy dissipation may be significant, and including an energy dissipation method may be necessary to accurately model the behavior of the material.

For example, in simulations of highly elastic materials, such as rubber or some polymers, energy dissipation may be negligible, and the simulation can be accurately modeled using a linear spring-dashpot system without any additional energy dissipation methods. In contrast, in simulations of granular materials, such as sand or rocks, energy dissipation can be significant due to friction, plastic deformation, and other energy dissipation mechanisms, and including an energy dissipation method may be necessary to accurately model the behavior of the material.

In general, it is important to carefully consider the material being simulated and the type of simulation being performed when deciding whether or not to include an energy dissipation method in a DEM simulation. If energy dissipation is expected to be significant, including an energy dissipation method can improve the accuracy and realism of the simulation. However, if energy dissipation is expected to be negligible, including an energy dissipation method may unnecessarily increase the computational cost of the simulation without improving the accuracy of the results.

**Shah Nawaz** what is spring dashpot

Raycast AI: A spring-dashpot system is a commonly used model in mechanics and engineering to represent the behavior of a viscoelastic material or a system with damping. The system consists of a spring and a dashpot connected in parallel, with the spring providing the elastic behavior and the dashpot providing the damping behavior.

The spring provides a restoring force that is proportional to the displacement of the system, while the dashpot provides a damping force that is proportional to the velocity of the system. The combination of the two elements allows the system to exhibit both elastic and damping behavior.

In a spring-dashpot system, the force acting on the system is given by:

F = -kx - c*dx/dt

where F is the force acting on the system, x is the displacement of the system, k is the spring constant, c is the damping coefficient, and dx/dt is the velocity of the system.

The first term on the right-hand side of the equation represents the elastic force due to the spring, while the second term represents the damping force due to the dashpot.

The spring-dashpot system is commonly used in discrete element method (DEM) simulations to model the behavior of granular materials and other complex systems. In DEM simulations, the spring-dashpot system is used to model the contact behavior between particles, with the spring representing the elastic deformation of the particles and the dashpot representing the energy dissipation due to friction and other damping mechanisms.

**Shah Nawaz** ellaborate with example of spherical particles and equations

Raycast AI: Sure, here is an example of using a spring-dashpot system to model the contact behavior between spherical particles in a discrete element method (DEM) simulation:

Consider two spherical particles i and j with radii r_i and r_j, respectively, and positions x_i and x_j, respectively. The contact force between the particles can be modeled using a spring-dashpot system, where the spring represents the elastic deformation of the particles and the dashpot represents the energy dissipation due to friction and other damping mechanisms.

The normal force between the particles is given by:

F_n = k_n * Δx - γ_n * v_n

where k_n is the normal stiffness, Δx is the overlap between the particles, γ_n is the normal damping coefficient, and v_n is the relative velocity between the particles along the direction of the normal vector.

The tangential force between the particles is given by:

F_t = min(F_s, μ * F_n) * v_t / ||v_t||

where F_s is the shear strength, μ is the coefficient of friction, F_n is the normal force, v_t is the relative velocity between the particles along the direction of the tangential vector, and ||v_t|| is the magnitude of the relative velocity.

The spring constant, k_n, can be calculated using Hertzian contact theory, which assumes that the particles behave as elastic spheres. The spring constant is given by:

k_n = (4/3)E*sqrt(r_i*r_j/(r_i+r_j)^3)*Δx^(3/2)

where E is the elastic modulus of the particles.

The damping coefficient, γ_n, can be calculated using the viscous damping model, which assumes that the energy dissipation is proportional to the relative velocity between the particles. The damping coefficient is given by:

γ_n = 2*sqrt(m_i*m_j)*η*sqrt(r_i*r_j/(r_i+r_j))

where m_i and m_j are the masses of the particles, η is the viscosity of the fluid, and the factor of 2 accounts for the fact that there are two contacting surfaces.

The shear strength, F_s, can be calculated using the Mohr-Coulomb failure criterion, which assumes that the shear strength of the particles depends on the normal force and the angle of internal friction, φ. The shear strength is given by:

F_s = F_n*tan(φ)

where φ is the angle of internal friction.

Overall, the spring-dashpot system provides a simple and effective way to model the contact behavior between spherical particles in DEM simulations, and the equations can be adjusted to account for different material properties and simulation conditions.

**Shah Nawaz** what are alternatives of spring dashpot

Raycast AI: There are several alternatives to the spring-dashpot system for modeling the contact behavior between particles in discrete element method (DEM) simulations. Some of the commonly used alternatives include:

1. Linear viscoelastic models: Linear viscoelastic models represent the material behavior as a combination of elastic and viscous properties, without explicitly modeling the contact behavior between particles. These models are based on the frequency-dependent complex modulus, which describes the response of the material to an applied stress or strain.

2. Nonlinear contact models: Nonlinear contact models explicitly model the contact behavior between particles using more complex contact laws that account for the nonlinear behavior of the material. These models can include additional terms to account for adhesion, surface roughness, and other effects that are not captured by the simple spring-dashpot system.

3. Discrete element method with bonded contacts: Discrete element method with bonded contacts is a variation of DEM that models the contact behavior between particles using bonded contacts, rather than the spring-dashpot system. Bonded contacts represent the material behavior as a network of interconnected particles, and can be used to model the behavior of cohesive materials and other complex systems.

4. Smoothed particle hydrodynamics: Smoothed particle hydrodynamics is a method that models the material as a continuous fluid, rather than discrete particles. This method can be used to model the behavior of fluids and other materials that exhibit continuous behavior, and can be combined with other methods, such as DEM, to model the behavior of mixed systems.

Overall, the choice of method depends on the specific material being simulated and the type of simulation being performed. Each method has its own advantages and disadvantages, and the appropriate method should be chosen based on the specific requirements of the simulation.

**Shah Nawaz** what are the forms of these models in mathematical form

Raycast AI: Sure, here are some of the mathematical forms of the alternative models for modeling the contact behavior between particles in discrete element method (DEM) simulations:

1. Linear viscoelastic models:

Linear viscoelastic models represent the material behavior as a combination of elastic and viscous properties, without explicitly modeling the contact behavior between particles. These models are based on the frequency-dependent complex modulus, which describes the response of the material to an applied stress or strain.

The complex modulus can be expressed as:

E* = E' + iE''

where E' is the storage modulus, which represents the elastic response of the material, E'' is the loss modulus, which represents the viscous response of the material, and i is the imaginary unit.

The complex modulus can be related to the frequency-dependent shear modulus, G*(ω), and the frequency-dependent viscosity, η(ω), using the following equations:

G*(ω) = E'(ω)

η(ω) = E''(ω) / ω

where ω is the angular frequency.

2. Nonlinear contact models:

Nonlinear contact models explicitly model the contact behavior between particles using more complex contact laws that account for the nonlinear behavior of the material. These models can include additional terms to account for adhesion, surface roughness, and other effects that are not captured by the simple spring-dashpot system.

One example of a nonlinear contact model is the Hertz-Mindlin model, which accounts for the nonlinear elastic behavior of the particles and the effect of friction on the contact behavior. The Hertz-Mindlin model is given by:

F_n = k_n * Δx^(3/2)

F_t = min(F_s, μ * F_n) * v_t / ||v_t||

where k_n is the normal stiffness, Δx is the overlap between the particles, μ is the coefficient of friction, F_s is the shear strength, v_t is the relative velocity between the particles along the direction of the tangential vector, and ||v_t|| is the magnitude of the relative velocity.

The normal stiffness, k_n, is calculated using Hertzian contact theory, while the shear strength, F_s, is calculated using the Mohr-Coulomb failure criterion.

3. Discrete element method with bonded contacts:

Discrete element method with bonded contacts is a variation of DEM that models the contact behavior between particles using bonded contacts, rather than the spring-dashpot system. Bonded contacts represent the material behavior as a network of interconnected particles, and can be used to model the behavior of cohesive materials and other complex systems.

The bonded contacts can be modeled using a variety of methods, including finite element analysis, lattice models, and other methods that allow for the calculation of the forces and stresses between the particles. The equations used to model the bonded contacts depend on the specific method being used.

4. Smoothed particle hydrodynamics:

Smoothed particle hydrodynamics is a method that models the material as a continuous fluid, rather than discrete particles. This method can be used to model the behavior of fluids and other materials that exhibit continuous behavior, and can be combined with other methods, such as DEM, to model the behavior of mixed systems.

In smoothed particle hydrodynamics, the material is represented as a set of particles that interact with each other through a smoothing kernel. The equations used to model the behavior of the material depend on the specific properties of the material being simulated, such as its viscosity, density, and compressibility.

Overall, the choice of method depends on the specific material being simulated and the type of simulation being performed. Each method has its own advantages and disadvantages, and the appropriate method should be chosen based on the specific requirements of the simulation.

**Shah Nawaz** is non smooth contact dynamics one of these

Raycast AI: Yes, non-smooth contact dynamics (NSCD) is another alternative to the spring-dashpot system for modeling the contact behavior between particles in discrete element method (DEM) simulations.

NSCD is a variation of DEM that models the contact behavior between particles using a set of non-smooth equations, which describe the instantaneous changes in the contact forces and velocities at the moment of contact. The non-smooth equations are based on the principle of minimum dissipation, which states that the contact forces and velocities should be chosen to minimize the dissipation of energy during the contact.

The non-smooth equations can be solved using a variety of numerical methods, including time-stepping methods and projection methods. The solution of the non-smooth equations allows for the calculation of the contact forces and velocities between the particles, which can be used to update the positions and velocities of the particles in the simulation.

NSCD has several advantages over the spring-dashpot system, including its ability to model the nonlinear behavior of the material, its ability to handle multiple contacts simultaneously, and its ability to model the effects of adhesion and surface roughness. However, NSCD can be computationally expensive and may require more advanced numerical methods than the spring-dashpot system.

Overall, NSCD is another alternative to the spring-dashpot system for modeling the contact behavior between particles in DEM simulations, and the appropriate method should be chosen based on the specific requirements of the simulation.

**Shah Nawaz** what is mathematical form of nscd

Raycast AI: Non-smooth contact dynamics (NSCD) uses a set of non-smooth equations to model the contact behavior between particles in discrete element method (DEM) simulations. The non-smooth equations describe the instantaneous changes in the contact forces and velocities at the moment of contact, and are based on the principle of minimum dissipation, which states that the contact forces and velocities should be chosen to minimize the dissipation of energy during the contact.

The non-smooth equations can be expressed in matrix form as:

M * Δv = J^T * λ

where M is the mass matrix, Δv is the change in velocity of the particles, J is the contact Jacobian matrix, and λ is the vector of Lagrange multipliers that represent the contact forces.

The mass matrix, M, is a diagonal matrix that represents the masses of the particles, while the contact Jacobian matrix, J, represents the geometry and elastic properties of the contacts between the particles.

The Lagrange multipliers, λ, are chosen to satisfy the principle of minimum dissipation, which states that the contact forces and velocities should be chosen to minimize the dissipation of energy during the contact. The Lagrange multipliers can be calculated using a projection method, which involves projecting the contact forces and velocities onto the constraint space defined by the non-smooth equations.

The solution of the non-smooth equations allows for the calculation of the contact forces and velocities between the particles, which can be used to update the positions and velocities of the particles in the simulation.

Overall, NSCD provides a powerful and flexible framework for modeling the contact behavior between particles in DEM simulations. However, the non-smooth equations can be computationally expensive and may require more advanced numerical methods than the spring-dashpot system.








**Shah Nawaz**: explain excitation force in discrete element 

**Raycast AI:** Excitation force in discrete element simulations refers to an external force applied to a system of discrete particles to induce motion or vibration. This force can be sinusoidal, random, or any other type of applied force. The excitation force can be used to study the behavior of granular materials under dynamic conditions, such as in the case of particle packing, segregation, or flow. The magnitude and frequency of the excitation force can be adjusted to simulate various real-world scenarios and study the response of the particle system.

**Shah Nawaz**: how we model this 

**Raycast AI:** To model excitation force in discrete element simulations, we typically define the force as an external input to the system of particles. This can be done by specifying the magnitude, direction, and frequency of the force, as well as the duration of the simulation. The excitation force can be applied to individual particles or to groups of particles, depending on the research question being investigated. 

In addition to defining the excitation force, we also need to consider the physical properties of the particles, such as their size, shape, and material properties, as well as the interactions between the particles, such as friction and cohesion. These properties are typically defined using mathematical models and empirical data, and are used to simulate the behavior of the particle system under the influence of the excitation force. 

Overall, the modeling of excitation force in discrete element simulations requires a combination of physics-based models, empirical data, and numerical methods to accurately simulate the behavior of granular materials under dynamic conditions.

**Shah Nawaz**: can you write some equations for me related to this force

**Raycast AI:** Sure, here are some equations related to excitation force in discrete element simulations:

1. Sinusoidal excitation force: A common form of excitation force is a sinusoidal force, which can be expressed as:

   F(t) = F0 sin(ωt)

   where F0 is the amplitude of the force, ω is the angular frequency, and t is time.

2. Random excitation force: In some cases, a random force may be used to simulate the effects of external disturbances on the particle system. A common way to model this is by using a Gaussian white noise process, which can be expressed as:

   F(t) = σξ(t)

   where σ is the standard deviation of the force, and ξ(t) is a Gaussian white noise process with zero mean and unit variance.

3. Total force on a particle: The total force on a particle in a discrete element simulation is the sum of all forces acting on the particle, including the excitation force. This can be expressed as:

   Ftotal = Fexcitation + Fcontact + Fgravity + Fother

   where Fcontact is the force due to particle-particle contacts, Fgravity is the force due to gravity, and Fother is any other external forces acting on the particle.

These equations are just a few examples of the many equations used in discrete element simulations to model excitation forces and their effects on granular materials.

**Shah Nawaz**: what is gaussian white noise in this case

**Raycast AI:** In the context of discrete element simulations and excitation forces, Gaussian white noise is a type of random signal that can be used to model external disturbances or fluctuations in the system. 

Gaussian white noise is a stochastic process where the amplitude of the signal varies randomly over time and the values of the signal at different times are uncorrelated (i.e., independent). The term "white" refers to the fact that the signal has equal power at all frequencies, meaning that it has a flat power spectral density.

In the case of excitation forces in discrete element simulations, Gaussian white noise can be used to represent random fluctuations in the external force acting on the system. This can be useful for studying the effects of external disturbances on the behavior of granular materials, such as the onset of instabilities or the formation of patterns.

To generate Gaussian white noise, we typically use a random number generator that produces values from a normal distribution with zero mean and unit variance, which are then scaled by a factor σ to control the overall amplitude of the signal. The resulting signal is a sequence of uncorrelated random values that can be used as the excitation force in the simulation.

**Shah Nawaz**: how these are generated

**Raycast AI:** Gaussian white noise can be generated using a random number generator that produces values from a normal distribution with zero mean and unit variance. There are various methods to generate Gaussian white noise, but one common approach is the Box-Muller transform, which involves transforming pairs of uniformly distributed random numbers into pairs of normally distributed random numbers.

Here are the general steps to generate Gaussian white noise:

1. Generate a sequence of uniformly distributed random numbers between 0 and 1 using a random number generator.

2. Apply the Box-Muller transform to the pairs of uniform random numbers to generate pairs of normally distributed random numbers with zero mean and unit variance.

3. Scale the resulting sequence of normally distributed random numbers by a factor σ to control the overall amplitude of the signal.

4. The resulting sequence of scaled, normally distributed random numbers represents the Gaussian white noise signal.

Once the Gaussian white noise signal has been generated, it can be used as the excitation force in the discrete element simulation. The amplitude and frequency of the excitation force can be adjusted to simulate various real-world scenarios and study the response of the particle system.

**Shah Nawaz**: how box-muller transform is applied on pairs of numbers

**Raycast AI:** The Box-Muller transform is a method for generating pairs of independent, normally distributed random numbers with zero mean and unit variance from pairs of independent, uniformly distributed random numbers between 0 and 1. Here's how the transform is applied on pairs of numbers:

1. Generate two independent, uniformly distributed random numbers U1 and U2 between 0 and 1.

2. Compute two new variables R and Θ as follows:

   R = sqrt(-2 * ln(U1))

   Θ = 2 * π * U2

   where ln denotes the natural logarithm, and π is the mathematical constant pi.

3. Compute two new variables X and Y as follows:

   X = R * cos(Θ)

   Y = R * sin(Θ)

4. The resulting pair of variables (X, Y) are independent, normally distributed random numbers with zero mean and unit variance.

The Box-Muller transform is a widely used method for generating Gaussian white noise and other types of random signals in many fields, including signal processing, finance, and simulation. The method is computationally efficient and produces high-quality random numbers that are suitable for many applications.

**Shah Nawaz**: in discrete element modelling what are forces involved other than normal force

**Raycast AI:** In discrete element modeling, other forces involved besides normal force include tangential force (friction), cohesive force (attraction between particles), and external forces such as gravity, applied forces, and fluid forces.

**Shah Nawaz**: show with equations

**Raycast AI:** Sure! Here are the equations for the forces involved in discrete element modeling:

1. Normal force: The force perpendicular to the contact surface between two particles. It is given by:

   **F<sub>n</sub> = k<sub>n</sub>δ<sup>n</sup>**

   where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient, and δ<sup>n</sup> is the overlap between the two particles.

2. Tangential force: The force parallel to the contact surface between two particles. It is given by:

   **F<sub>t</sub> = -k<sub>t</sub>δ<sup>t</sup> - γv<sub>t</sub>**

   where F<sub>t</sub> is the tangential force, k<sub>t</sub> is the tangential stiffness coefficient, δ<sup>t</sup> is the sliding displacement between the two particles, γ is the damping coefficient, and v<sub>t</sub> is the relative tangential velocity between the two particles.

3. Cohesive force: The attractive force between two particles. It is given by:

   **F<sub>c</sub> = -k<sub>c</sub>δ<sup>c</sup>**

   where F<sub>c</sub> is the cohesive force, k<sub>c</sub> is the cohesive stiffness coefficient, and δ<sup>c</sup> is the distance between the two particles.

4. External forces: These include gravity, applied forces, and fluid forces. The equations for these forces depend on the specific situation and can be derived from Newton's laws of motion.

Note that these equations are simplified and may not be applicable to all situations. Different models may use different equations or variations of these equations.

**Shah Nawaz**: what is stiffness coefficient

**Raycast AI:** Stiffness coefficient is a parameter that describes the stiffness of a material or a system. In the context of discrete element modeling, stiffness coefficient refers to the parameter that characterizes the elastic response of the particles when they are in contact with each other. 

For example, in the equation for the normal force between two particles in discrete element modeling, the stiffness coefficient (k<sub>n</sub>) represents the resistance of the particles to compression. A higher value of k<sub>n</sub> means that the particles are more resistant to compression and will require a higher force to be compressed.

The stiffness coefficient can be determined experimentally or through theoretical calculations based on the material properties of the particles and the geometry of the system. It is an important parameter in discrete element modeling as it affects the behavior of the particles and the overall simulation results.

**Shah Nawaz**: how to determine this for an experiment with 3d spherical particles

**Raycast AI:** To determine the stiffness coefficient for an experiment with 3D spherical particles, you can perform a compression test on a single particle or a bed of particles. Here are the general steps:

1. Prepare a sample of spherical particles that are representative of the material you want to model. The particles should be of uniform size and shape.

2. Place the sample in a compression device that can apply a controlled force to the particles. The device should be capable of measuring the displacement and force during compression.

3. Apply a compressive force to the sample and record the force-displacement data. The force-displacement curve should be linear in the elastic region of deformation.

4. Calculate the stiffness coefficient using the slope of the force-displacement curve in the linear elastic region. The stiffness coefficient is equal to the ratio of the applied force to the displacement.

5. Repeat the test for multiple samples and calculate the average stiffness coefficient. This will give you a more accurate representation of the material properties.

Note that the calculation of stiffness coefficient assumes that the particles behave elastically and that there is no permanent deformation or breakage. If the particles exhibit plastic deformation or fracture, the stiffness coefficient may not be a suitable parameter for modeling the material.

**Shah Nawaz**: what is force displacement curve

**Raycast AI:** A force-displacement curve is a graph that shows the relationship between the applied force and the resulting displacement of a material or structure under load. It is commonly used in materials testing and mechanical engineering to characterize the mechanical behavior of a material or component.

In a force-displacement curve, the x-axis represents the displacement or deformation of the material or structure, while the y-axis represents the applied force. The curve typically starts at the origin, where there is no applied force and no displacement, and increases as the force is applied and the material or structure deforms.

The shape of the force-displacement curve depends on the properties of the material or structure being tested. In the elastic region of deformation, the curve is typically linear, indicating that the material or structure is behaving elastically and will return to its original shape when the force is removed. In the plastic region of deformation, the curve becomes nonlinear, indicating that the material or structure is undergoing permanent deformation or yielding.

The force-displacement curve can provide important information about the mechanical properties of a material or structure, such as its stiffness, strength, and ductility. It can also be used to determine the failure point of the material or structure, where it can no longer support the applied load and breaks or collapses.

**Shah Nawaz**: in dem what is role of stiffness coefficients

**Raycast AI:** In Discrete Element Method (DEM), stiffness coefficients play a critical role in determining the behavior of the particles and the overall simulation results. 

The stiffness coefficients are used to describe the elastic response of the particles when they are in contact with each other. In DEM simulations, the particles are modeled as discrete entities that interact with each other through contact forces. The stiffness coefficients are used to calculate the magnitude of these contact forces, based on the amount of overlap or relative displacement between the particles.

For example, in the equation for the normal force between two particles in DEM, the stiffness coefficient (k<sub>n</sub>) represents the resistance of the particles to compression. A higher value of k<sub>n</sub> means that the particles are more resistant to compression and will require a higher force to be compressed.

The stiffness coefficients can be determined experimentally or through theoretical calculations based on the material properties of the particles and the geometry of the system. They can be adjusted to simulate different materials or particle shapes, and to study the effects of different loading conditions or boundary conditions.

Overall, the stiffness coefficients are a critical parameter in DEM simulations, as they affect the behavior of the particles and the overall simulation results. Accurate determination of stiffness coefficients is important for the reliable prediction of the behavior of granular materials in various engineering applications.

**Shah Nawaz**: in this context what is kappa in dem

**Raycast AI:** In Discrete Element Method (DEM), kappa (κ) is a parameter that is used to describe the contact properties between particles. Specifically, kappa is a measure of the degree of tangential displacement that is allowed between particles during contact.

In DEM simulations, the contact between particles is modeled as a combination of normal and tangential forces. The normal force is calculated based on the overlap or penetration depth between the particles, while the tangential force is calculated based on the relative tangential displacement between the particles.

Kappa is used to define the maximum amount of tangential displacement that is allowed between particles during contact. It is defined as the ratio of the maximum tangential force that can be applied between particles to the normal force. In other words, kappa represents the maximum ratio of the tangential force to the normal force.

A higher value of kappa means that the particles are able to slide more easily past each other during contact, while a lower value of kappa means that the particles are more resistant to tangential displacement and will require a higher tangential force to slide past each other.

The value of kappa can be determined experimentally or through theoretical calculations based on the material properties of the particles and the geometry of the system. It is an important parameter in DEM simulations, as it affects the behavior of the particles and the overall simulation results.

**Shah Nawaz**: show with equation

**Raycast AI:** Sure! Here is the equation that defines kappa in Discrete Element Method (DEM):

**κ = F<sub>t,max</sub> / F<sub>n</sub>**

where κ is the kappa parameter, F<sub>t,max</sub> is the maximum tangential force that can be applied between particles, and F<sub>n</sub> is the normal force between particles.

The maximum tangential force, F<sub>t,max</sub>, is typically defined as a function of the normal force, F<sub>n</sub>, and a friction coefficient, μ. The friction coefficient represents the resistance of the particles to sliding past each other during contact.

One common way to define the maximum tangential force is through the Coulomb friction law:

**F<sub>t,max</sub> = μF<sub>n</sub>**

where μ is the friction coefficient.

Substituting this expression into the equation for kappa, we get:

**κ = μ**

This shows that kappa is equal to the friction coefficient in the Coulomb friction model. In other words, kappa represents the maximum ratio of the tangential force to the normal force that can be applied between particles during contact, based on the frictional properties of the particles.

**Shah Nawaz**: in this case how kappa is effected by interparticle friction coefficient

**Raycast AI:** In the Coulomb friction model, which is commonly used in Discrete Element Method (DEM) simulations, kappa is equal to the interparticle friction coefficient, μ. Therefore, any changes in the interparticle friction coefficient will directly affect the value of kappa.

If the interparticle friction coefficient is increased, the value of kappa will also increase, indicating that the particles are more resistant to tangential displacement during contact. This means that a higher tangential force will be required to slide the particles past each other. On the other hand, if the interparticle friction coefficient is decreased, the value of kappa will also decrease, indicating that the particles are less resistant to tangential displacement during contact. This means that a lower tangential force will be required to slide the particles past each other.

It is important to note that the Coulomb friction model is a simplified model that assumes that the friction coefficient is constant and independent of the normal force and sliding velocity. In reality, the friction coefficient may vary depending on the specific properties of the particles and the conditions of the simulation. Therefore, it is important to calibrate the value of the interparticle friction coefficient and kappa based on experimental data or empirical correlations to ensure accurate simulation results.

**Shah Nawaz**: and if the model is linear elastic 

**Raycast AI:** If the model is linear elastic, then kappa may not directly depend on the interparticle friction coefficient. In a linear elastic model, the contact forces between particles are proportional to the amount of overlap or relative displacement between the particles, and the stiffness coefficients determine the proportionality constant. In this case, the value of kappa may be determined by the ratio of the tangential stiffness coefficient to the normal stiffness coefficient.

For example, in the Hertzian contact model, which is a linear elastic model commonly used in DEM simulations, the normal stiffness coefficient is determined by the elastic modulus and the radius of the particles, while the tangential stiffness coefficient is determined by the shear modulus and the radius of the particles. In this case, the value of kappa is determined by the ratio of the shear modulus to the elastic modulus.

The interparticle friction coefficient may still affect the behavior of the particles indirectly, by influencing the amount of overlap or relative displacement between the particles during contact. For example, a higher interparticle friction coefficient may cause the particles to stick together more strongly during contact, resulting in a larger amount of overlap and a higher normal force. This, in turn, may affect the value of kappa indirectly, by changing the stiffness coefficients or the amount of tangential displacement that is allowed between the particles.

Overall, the relationship between kappa and the interparticle friction coefficient depends on the specific model and assumptions used in the simulation, and may require calibration based on experimental data or empirical correlations.

**Shah Nawaz**: prove with some equations

**Raycast AI:** Sure! Here is an example of how kappa can be related to the stiffness coefficients in a linear elastic model:

In the Hertzian contact model, the normal force between two particles is given by:

**F<sub>n</sub> = k<sub>n</sub>δ<sup>n</sup>**

where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient, and δ<sup>n</sup> is the overlap between the two particles.

The tangential force between two particles is given by:

**F<sub>t</sub> = k<sub>t</sub>δ<sup>t</sup>**

where F<sub>t</sub> is the tangential force, k<sub>t</sub> is the tangential stiffness coefficient, and δ<sup>t</sup> is the relative tangential displacement between the two particles.

In a linear elastic model, the stiffness coefficients are related to the elastic moduli of the particles and the geometry of the system. For example, in the Hertzian contact model, the normal stiffness coefficient is given by:

**k<sub>n</sub> = (4/3)E<sub>r</sub>√(R<sub>1</sub>R<sub>2</sub>)**

where E<sub>r</sub> is the reduced elastic modulus of the particles, R<sub>1</sub> and R<sub>2</sub> are the radii of the two particles, and the factor of 4/3 accounts for the three-dimensional nature of the problem.

Similarly, the tangential stiffness coefficient can be related to the shear modulus of the particles. For example, in a linear elastic model, the tangential stiffness coefficient can be approximated as:

**k<sub>t</sub> = 2G√(R<sub>1</sub>R<sub>2</sub>)**

where G is the shear modulus of the particles.

Using these equations, we can relate kappa to the stiffness coefficients as follows:

**κ = F<sub>t,max</sub> / F<sub>n</sub> = k<sub>t</sub> / k<sub>n</sub> = 2G / (4/3)E<sub>r</sub>**

This shows that kappa is proportional to the ratio of the shear modulus to the reduced elastic modulus of the particles. Therefore, in a linear elastic model, kappa may not directly depend on the interparticle friction coefficient, but may depend on the elastic properties of the particles and the geometry of the system.

**Shah Nawaz**: what  is difference between hertz contact model and linear elastic model

**Raycast AI:** The Hertz contact model and the linear elastic model are both used to describe the contact between two elastic bodies, such as particles in a granular material. However, there are some key differences between the two models.

The Hertz contact model is a nonlinear model that describes the contact between two elastic bodies with curved surfaces. It is based on the theory of elasticity and assumes that the deformation of the bodies is small and the contact area is small compared to the radii of the bodies. The model calculates the normal and tangential forces between the bodies based on the amount of overlap or penetration depth between the bodies and the curvature of the surfaces. The Hertz contact model is commonly used in Discrete Element Method (DEM) simulations to model the contact between spherical particles.

The linear elastic model, on the other hand, is a simpler model that assumes that the elastic deformation of the bodies is linearly proportional to the applied load. It is based on Hooke's law and assumes that the bodies are perfectly smooth and have flat contact surfaces. The model calculates the normal and tangential forces between the bodies based on the stiffness coefficients of the bodies and the amount of overlap or relative displacement between the bodies. The linear elastic model is commonly used in analytical calculations and finite element simulations to model the contact between bodies with simple geometries.

One key difference between the two models is the assumption about the shape of the contact surfaces. The Hertz contact model assumes that the surfaces are curved, while the linear elastic model assumes that the surfaces are flat. This can affect the accuracy of the model, especially when the bodies have complex shapes or the contact area is large.

Another difference is the complexity of the equations used to calculate the forces. The Hertz contact model has more complex equations that involve integrals and elliptic functions, while the linear elastic model has simpler equations that involve the stiffness coefficients and the amount of overlap or relative displacement.

Overall, both models have their advantages and disadvantages, and the choice of model depends on the specific application and the level of accuracy required. The Hertz contact model is more accurate for modeling the contact between curved surfaces, while the linear elastic model is simpler and more computationally efficient for modeling the contact between flat surfaces.

**Shah Nawaz**: show with equations

**Raycast AI:** Sure! Here are the equations that describe the contact forces in the Hertz contact model and the linear elastic model:

1. Hertz contact model:

The normal force between two elastic bodies with curved surfaces in the Hertz contact model is given by:

**F<sub>n</sub> = (4/3)E√Rδ<sup>3/2</sup>**

where F<sub>n</sub> is the normal force, E is the elastic modulus of the bodies, R is the radius of curvature of the bodies, and δ is the overlap or penetration depth between the bodies.

The tangential force between the bodies in the Hertz contact model is given by:

**F<sub>t</sub> = μF<sub>n</sub>tan(φ)**

where F<sub>t</sub> is the tangential force, μ is the coefficient of friction between the bodies, φ is the angle of relative tangential displacement between the bodies, and tan(φ) is the tangent of the angle of relative tangential displacement.

2. Linear elastic model:

The normal force between two elastic bodies with flat surfaces in the linear elastic model is given by:

**F<sub>n</sub> = k<sub>n</sub>δ**

where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient of the bodies, and δ is the overlap or relative displacement between the bodies.

The tangential force between the bodies in the linear elastic model is given by:

**F<sub>t</sub> = k<sub>t</sub>δ<sub>t</sub>**

where F<sub>t</sub> is the tangential force, k<sub>t</sub> is the tangential stiffness coefficient of the bodies, and δ<sub>t</sub> is the relative tangential displacement between the bodies.

In the linear elastic model, the normal and tangential stiffness coefficients are related to the elastic modulus and the geometry of the bodies. For example, for two spheres of radius R<sub>1</sub> and R<sub>2</sub>, the normal stiffness coefficient is given by:

**k<sub>n</sub> = (4/3)E√R**

where E is the elastic modulus of the bodies, and R is the equivalent radius of the contact area, given by:

**R = (R<sub>1</sub>R<sub>2</sub>) / (R<sub>1</sub> + R<sub>2</sub>)**

The tangential stiffness coefficient can be related to the shear modulus of the bodies and the geometry of the contact area. For example, for two spheres in contact, the tangential stiffness coefficient can be approximated as:

**k<sub>t</sub> = 8G√(R<sub>1</sub>R<sub>2</sub>) / (3π(R<sub>1</sub> + R<sub>2</sub>))**

where G is the shear modulus of the bodies.

These equations show that the Hertz contact model and the linear elastic model have different equations for calculating the contact forces, and that the stiffness coefficients in the linear elastic model are related to the elastic modulus and the geometry of the bodies. The choice of model depends on the specific application and the level of accuracy required.

**Shah Nawaz**: how  increasing kt or kn effects these models

**Raycast AI:** Increasing the normal stiffness coefficient (k<sub>n</sub>) or the tangential stiffness coefficient (k<sub>t</sub>) in the linear elastic model or the Hertz contact model can affect the behavior of the models in different ways.

In the linear elastic model, increasing the normal stiffness coefficient will increase the normal force between the bodies for a given amount of overlap or relative displacement. This means that the bodies will be more resistant to deformation and will require a higher force to compress or separate them. Increasing the tangential stiffness coefficient will increase the tangential force between the bodies for a given amount of relative tangential displacement. This means that the bodies will be more resistant to sliding past each other and will require a higher force to initiate or maintain sliding.

In the Hertz contact model, increasing the normal stiffness coefficient will also increase the normal force between the bodies for a given amount of overlap or penetration depth. However, the relationship between the normal force and the overlap is nonlinear in the Hertz contact model, and the force can increase rapidly as the overlap approaches zero. This means that increasing the normal stiffness coefficient can lead to a more rapid increase in the force and can affect the behavior of the model at small overlaps. Increasing the tangential stiffness coefficient in the Hertz contact model will increase the stiffness of the contact interface and can affect the behavior of the model during sliding or rolling of the bodies.

Overall, increasing the stiffness coefficients in both models can affect the behavior of the models by making the bodies more resistant to deformation or sliding. However, the specific effects depend on the model and the specific conditions of the simulation, and may require calibration based on experimental data or empirical correlations.

**Shah Nawaz**: are these contact models of dem?

**Raycast AI:** Yes, both the Hertz contact model and the linear elastic model are commonly used in Discrete Element Method (DEM) simulations to model the contact between particles or other elastic bodies.

In DEM simulations, the particles or bodies are modeled as discrete entities that interact with each other through contact forces. The contact forces are typically calculated based on the amount of overlap or relative displacement between the particles or bodies, and the stiffness coefficients or contact parameters that describe the elastic properties of the particles or bodies.

The Hertz contact model is a nonlinear model that is commonly used to model the contact between spherical particles in DEM simulations. The model is based on the theory of elasticity and assumes that the particles are perfectly spherical and have curved surfaces. The model calculates the normal and tangential forces between the particles based on the amount of overlap or penetration depth between the particles and the curvature of the surfaces.

The linear elastic model is a simpler model that is commonly used to model the contact between particles or bodies with simple geometries in DEM simulations. The model assumes that the particles or bodies have flat contact surfaces and that the elastic deformation is linearly proportional to the applied load. The model calculates the normal and tangential forces between the particles or bodies based on the stiffness coefficients and the amount of overlap or relative displacement between the particles or bodies.

Both models have their advantages and disadvantages, and the choice of model depends on the specific application and the level of accuracy required.

**Shah Nawaz**: what are other contact models in dem

**Raycast AI:** There are several other contact models that are commonly used in Discrete Element Method (DEM) simulations to model the contact between particles or other elastic bodies. Some of the commonly used models include:

1. Mindlin model: The Mindlin model is a nonlinear model that accounts for the tangential compliance of the contact interface. The model assumes that the contact interface is composed of a layer of elastic springs that deform under tangential loading. The tangential force is calculated based on the deformation of the springs and the frictional properties of the particles.

2. JKR model: The Johnson-Kendall-Roberts (JKR) model is a nonlinear model that accounts for the adhesive forces between particles or bodies. The model assumes that the particles or bodies are perfectly spherical and have flat contact surfaces. The model calculates the normal and tangential forces between the particles or bodies based on the stiffness coefficients and the amount of overlap or relative displacement, as well as the adhesive forces between the particles or bodies.

3. Cundall-Strack model: The Cundall-Strack model is a nonlinear model that accounts for the rolling and twisting of particles during contact. The model assumes that the particles have six degrees of freedom and can rotate and translate during contact. The contact forces are calculated based on the amount of overlap or relative displacement and the frictional properties of the particles.

4. Soft-sphere model: The soft-sphere model is a nonlinear model that accounts for the deformation of the particles during contact. The model assumes that the particles are perfectly spherical and have elastic properties that depend on the amount of deformation. The contact forces are calculated based on the amount of overlap or relative displacement and the elastic properties of the particles.

These are just a few examples of the many contact models that are used in DEM simulations. The choice of model depends on the specific application and the level of accuracy required.

**Shah Nawaz**: show equations

**Raycast AI:** Sure! Here are the equations that describe the contact forces in some of the other commonly used contact models in Discrete Element Method (DEM) simulations:

1. Mindlin model:

The normal force between two elastic bodies in the Mindlin model is given by:

**F<sub>n</sub> = k<sub>n</sub>δ + k<sub>t</sub>δ<sup>3/2</sup>**

where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient, k<sub>t</sub> is the tangential stiffness coefficient, and δ is the overlap or penetration depth between the bodies.

The tangential force between the bodies in the Mindlin model is given by:

**F<sub>t</sub> = min(μF<sub>n</sub>, k<sub>t</sub>δ<sup>1/2</sup>)tan(φ)**

where F<sub>t</sub> is the tangential force, μ is the coefficient of friction, φ is the angle of relative tangential displacement between the bodies, and min(μF<sub>n</sub>, k<sub>t</sub>δ<sup>1/2</sup>) is the minimum of the frictional force and the tangential stiffness force.

2. JKR model:

The normal force between two elastic bodies in the JKR model is given by:

**F<sub>n</sub> = k<sub>n</sub>δ - 2πRγ<sub>s</sub>**

where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient, δ is the overlap or penetration depth between the bodies, R is the radius of the bodies, and γ<sub>s</sub> is the surface energy of the bodies.

The tangential force between the bodies in the JKR model is given by:

**F <sub>t</sub> = min(μF<sub>n</sub>, k<sub>t</sub>δ)tan(φ)**

where F<sub>t</sub> is the tangential force, μ is the coefficient of friction, k<sub>t</sub> is the tangential stiffness coefficient, δ is the overlap or relative displacement between the bodies, and φ is the angle of relative tangential displacement between the bodies.

3. Cundall-Strack model:

The normal force between two elastic bodies in the Cundall-Strack model is given by:

**F<sub>n</sub> = k<sub>n</sub>δ**

where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient, and δ is the overlap or relative displacement between the bodies.

The tangential force between the bodies in the Cundall-Strack model is given by:

**F<sub>t</sub> = -k<sub>t</sub>δ<sub>t</sub> - k<sub>r</sub>δ<sub>r</sub>**

where F<sub>t</sub> is the tangential force, k<sub>t</sub> is the tangential stiffness coefficient, k<sub>r</sub> is the rolling stiffness coefficient, δ<sub>t</sub> is the relative tangential displacement between the bodies, and δ<sub>r</sub> is the relative rotation between the bodies.

4. Soft-sphere model:

The normal force between two elastic bodies in the soft-sphere model is given by:

**F<sub>n</sub> = k<sub>n</sub>δ + k<sub>h</sub>δ<sup>3/2</sup>**

where F<sub>n</sub> is the normal force, k<sub>n</sub> is the normal stiffness coefficient, k<sub>h</sub> is the Hertz stiffness coefficient, and δ is the overlap or penetration depth between the bodies.

The tangential force between the bodies in the soft-sphere model is given by:

**F<sub>t</sub> = min(μF<sub>n</sub>, k<sub>t</sub>δ<sup>1/2</sup>)tan(φ)**

where F<sub>t</sub> is the tangential force, μ is the coefficient of friction, k<sub>t</sub> is the tangential stiffness coefficient, δ is the overlap or relative displacement between...

**Shah Nawaz**: continue

**Raycast AI:** ...the bodies, and φ is the angle of relative tangential displacement between the bodies.

These equations show that the different contact models in DEM simulations have different equations for calculating the contact forces between particles or bodies. The Mindlin model accounts for the tangential compliance of the contact interface, the JKR model accounts for adhesive forces, the Cundall-Strack model accounts for rolling and twisting of particles, and the soft-sphere model accounts for the deformation of the particles during contact.

The specific choice of model depends on the specific application and the level of accuracy required. The models may also require calibration based on experimental data or empirical correlations.

**Shah Nawaz**: which one is contact dynamics model and molecular dynamics model

**Raycast AI:** Contact Dynamics (CD) and Molecular Dynamics (MD) are two different simulation methods used to study the behavior of particles or other elastic bodies.

Contact Dynamics is a method that is used to simulate the motion and interactions of particles or other elastic bodies in contact. In CD simulations, the particles are modeled as discrete entities that interact with each other through contact forces. The contact forces are typically calculated based on the amount of overlap or relative displacement between the particles or bodies, and the elastic properties of the particles or bodies. CD simulations can be used to study the behavior of granular materials, powders, and other systems where the particles are in contact.

Molecular Dynamics is a method that is used to simulate the motion and interactions of atoms or molecules in a system. In MD simulations, the atoms or molecules are modeled as discrete entities that interact with each other through interatomic or intermolecular forces. The forces are typically calculated based on empirical potentials or force fields that describe the interactions between the atoms or molecules. MD simulations can be used to study the behavior of materials at the atomic or molecular scale, and are commonly used in materials science, chemistry, and biophysics.

Both CD and MD simulations can be used to study the behavior of particles or other elastic bodies, but they use different models and methods to calculate the forces between the particles or bodies. CD simulations are based on contact mechanics and use contact models to calculate the forces, while MD simulations are based on interatomic or intermolecular forces and use force fields to calculate the forces.

In summary, Contact Dynamics is a simulation method used to study the behavior of particles or other elastic bodies in contact, while Molecular Dynamics is a simulation method used to study the behavior of atoms or molecules in a system.

**Shah Nawaz**: show how these models work

**Raycast AI:** Sure! Here's a brief overview of how the Contact Dynamics (CD) and Molecular Dynamics (MD) models work:

1. Contact Dynamics:

In Contact Dynamics simulations, the particles or bodies are modeled as discrete entities that interact with each other through contact forces. The simulation proceeds by iteratively calculating the forces and velocities of the particles based on the current positions and velocities of the particles, and the elastic properties of the particles or bodies.

The contact forces between the particles are typically calculated based on the amount of overlap or relative displacement between the particles, and the elastic properties of the particles or bodies. The forces can be calculated using a variety of contact models, such as the Hertz contact model, the linear elastic model, or the Mindlin model.

The simulation proceeds by calculating the forces and velocities of the particles at each time step, and updating the positions and velocities of the particles based on the calculated forces and velocities. The simulation can be run for a specified duration or until a specific criterion is met.

Contact Dynamics simulations are commonly used to study the behavior of granular materials, powders, and other systems where the particles are in contact.

2. Molecular Dynamics:

In Molecular Dynamics simulations, the atoms or molecules in the system are modeled as discrete entities that interact with each other through interatomic or intermolecular forces. The simulation proceeds by iteratively calculating the forces and velocities of the atoms or molecules based on the current positions and velocities of the atoms or molecules, and the force field that describes the interactions between the atoms or molecules.

The force field is typically described by a set of empirical potentials that describe the interactions between the atoms or molecules. The potentials can be chosen from a variety of functional forms, such as Lennard-Jones potentials, Coulombic potentials, or bonded potentials.

The simulation proceeds by calculating the forces and velocities of the atoms or molecules at each time step, and updating the positions and velocities of the atoms or molecules based on the calculated forces and velocities. The simulation can be run for a specified duration or until a specific criterion is met.

Molecular Dynamics simulations are commonly used to study the behavior of materials at the atomic or molecular scale, and are commonly used in materials science, chemistry, and biophysics.

Overall, both Contact Dynamics and Molecular Dynamics simulations use iterative methods to calculate the forces and velocities of the particles or atoms, and update their positions and velocities based on the calculated forces and velocities. The specific methods and models used depend on the specific application and the level of accuracy required.

**Shah Nawaz**: show with equations

**Raycast AI:** Sure! Here are some of the equations that are commonly used in Contact Dynamics (CD) and Molecular Dynamics (MD) simulations:

1. Contact Dynamics:

The normal force between two particles in CD simulations is typically calculated using the Hertz contact model, which is given by:

**F<sub>n</sub> = 4/3E*sqrt(Rδ)δ**

where F<sub>n</sub> is the normal force, E* is the effective Young's modulus of the particles, R is the radius of the particles, and δ is the overlap or penetration depth between the particles.

The tangential force between the particles in CD simulations is typically calculated using Coulomb's law of friction, which is given by:

**F<sub>t</sub> = -μF<sub>n</sub>tan(φ)**

where F<sub>t</sub> is the tangential force, μ is the coefficient of friction, F<sub>n</sub> is the normal force, and φ is the angle of relative tangential displacement between the particles.

2. Molecular Dynamics:

The force between two atoms or molecules in MD simulations is typically calculated using an empirical potential that describes the interactions between the atoms or molecules. One commonly used potential is the Lennard-Jones potential, which is given by:

**U(r) = 4ε[(σ/r)<sup>12</sup> - (σ/r)<sup>6</sup>]**

where U(r) is the potential energy between the atoms or molecules, ε is the depth of the potential well, σ is the distance at which the potential energy is zero, and r is the distance between the atoms or molecules.

The force between the atoms or molecules is then calculated by taking the negative gradient of the potential energy, which is given by:

**F = -∇U(r)**

where F is the force between the atoms or molecules, and ∇U(r) is the gradient of the potential energy with respect to the distance between the atoms or molecules.

The positions and velocities of the atoms or molecules are then updated based on the calculated forces and velocities, using the equations of motion:

**r(t + Δt) = r(t) + v(t)Δt + 1/2a(t)Δt<sup>2</sup>**

**v(t + Δt) = v(t) + 1/2[a(t) + a(t + Δt)]Δt**

where r(t) and v(t) are the position and velocity of the atoms or molecules at time t, a(t) is the acceleration of the atoms or molecules at time t, and Δt is the time step of the simulation.

These equations show how the forces, positions, and velocities of the particles or atoms are calculated and updated in CD and MD simulations. The specific equations and parameters used depend on the specific application and the level of accuracy required.

**Shah Nawaz**: what is difference between quasistatic model and linear elastic model in discrete element method for granular materials

**Raycast AI:** The quasi-static model in discrete element method for granular materials assumes that the particles move slowly enough for static equilibrium to be maintained at all times, whereas the linear elastic model assumes that the particles behave elastically and obey Hooke's law. In the quasi-static model, particle contacts are modeled as rigid and frictional, while in the linear elastic model, particle contacts are modeled as linear springs. The quasi-static model is suitable for simulating slow processes such as compaction, while the linear elastic model is suitable for simulating fast processes such as impact.

**Shah Nawaz**: show with equations

**Raycast AI:** Sure, here are the equations for the two models:

Quasi-static model:
-  Contact force: $f_{ij} = k_n \delta_{ij}^{n} \hat{n}_{ij} + k_t \delta_{ij}^{t} \hat{t}_{ij}$
-  Frictional sliding: $\delta_{ij}^{t} = \min(\mu_{ij} \delta_{ij}^{n}, |\delta_{ij}^{t}|)$
-  Normal displacement: $\delta_{ij}^{n} = \max(0, r_i + r_j - |\boldsymbol{x}_i - \boldsymbol{x}_j|)$

Linear elastic model:
-  Contact force: $f_{ij} = k_n \delta_{ij}^{n} \hat{n}_{ij} + k_t \delta_{ij}^{t} \hat{t}_{ij}$
-  Hooke's law: $\delta_{ij}^{n} = (r_i + r_j - |\boldsymbol{x}_i - \boldsymbol{x}_j|)$ and $\delta_{ij}^{t} = \boldsymbol{v}_{ij} \cdot \hat{t}_{ij}$
-  Spring constants: $k_n = \frac{4}{3} E^* \sqrt{R^*} $ and $k_t = 2G^* \sqrt{R^*}$

In these equations, $f_{ij}$ is the contact force between particles $i$ and $j$, $\delta_{ij}^{n}$ and $\delta_{ij}^{t}$ are the normal and tangential displacements between the particles, $\hat{n}_{ij}$ and $\hat{t}_{ij}$ are the normal and tangential unit vectors, $k_n$ and $k_t$ are the normal and tangential spring constants, $E^*$ and $G^*$ are the effective Young's modulus and shear modulus of the particles, and $R^*$ is the effective radius of the particles. The friction coefficient between particles $i$ and $j$ is denoted by $\mu_{ij}$, and $\boldsymbol{v}_{ij}$ is the relative velocity between the particles.

**Shah Nawaz**: how material is caliberated in discrete element method

**Raycast AI:** In discrete element method (DEM), material properties are typically calibrated using experimental data. The calibration process involves adjusting the input parameters of the DEM simulation, such as particle size, shape, density, and contact parameters, to match the behavior of the material observed in experiments. The goal of calibration is to obtain a set of input parameters that accurately represent the material's mechanical behavior under different loading conditions.

The calibration process usually involves performing a series of simulations with different input parameters and comparing the simulation results to experimental data. The input parameters are adjusted until the simulation results match the experimental data within an acceptable tolerance. The calibration process can be iterative, with the input parameters adjusted multiple times until a satisfactory match is obtained.

Calibration is an important step in DEM simulations, as accurate material properties are essential for obtaining reliable simulation results. However, it can be a challenging and time-consuming process, as it requires a good understanding of both the material behavior and the DEM simulation methodology.

**Shah Nawaz**: show method with equations

**Raycast AI:** The calibration process in discrete element method (DEM) typically involves adjusting the input parameters of the simulation to match the behavior of the material observed in experiments. Here is a general method for calibrating DEM parameters:

1. Define the material properties: The first step is to define the material properties of the particles in the simulation, such as particle size, shape, density, and mechanical properties (e.g., Young's modulus, Poisson's ratio, and friction coefficient).

2. Perform experiments: Conduct experiments to measure the material behavior under different loading conditions, such as compression, shear, and impact. Record the relevant data, such as stress-strain curves, deformation profiles, and particle trajectories.

3. Set up the DEM simulation: Set up a DEM simulation that replicates the experimental conditions. This involves specifying the particle properties, boundary conditions, and loading conditions.

4. Run the simulation: Run the DEM simulation and record the simulation results, such as particle trajectories, contact forces, and deformation profiles.

5. Compare simulation results with experimental data: Compare the simulation results with the experimental data to assess the accuracy of the simulation. This can involve comparing stress-strain curves, deformation profiles, and particle trajectories.

6. Adjust input parameters: Adjust the input parameters of the DEM simulation to improve the match between the simulation results and the experimental data. This can involve adjusting particle properties, such as size, shape, and density, as well as contact parameters, such as the normal and tangential stiffness and damping coefficients.

7. Repeat steps 4-6: Repeat steps 4-6 until a satisfactory match is obtained between the simulation results and the experimental data.

8. Validate the calibrated model: Validate the calibrated model by comparing the simulation results with new experimental data that was not used in the calibration process.

The specific equations used in the calibration process will depend on the material being studied and the experimental setup. However, the general method outlined above can be applied to a wide range of materials and loading conditions.

**Shah Nawaz**: what are the parameters involved in dem shear experiments 

**Raycast AI:** In a Discrete Element Method (DEM) simulation of a shear experiment, the parameters involved include:

1. Particle properties: The properties of the individual particles, such as size, shape, density, and mechanical properties (e.g., Young's modulus, Poisson's ratio, and friction coefficient).

2. Boundary conditions: The boundary conditions of the simulation, such as the type of walls or boundaries used to confine the particles.

3. Loading conditions: The loading conditions of the simulation, such as the direction and magnitude of the applied shear force.

4. Contact parameters: The parameters that govern the interaction between particles, such as the normal and tangential stiffness and damping coefficients, the friction coefficient, and the rolling resistance coefficient.

5. Simulation parameters: The parameters that control the numerical accuracy and stability of the simulation, such as the time step size, the number of particles, and the number of iterations.

6. Output parameters: The parameters that are used to analyze the simulation results, such as the shear stress, shear strain, and particle velocities.

In a shear experiment, the applied force is typically in the horizontal direction, and the particles are subjected to a combination of normal and tangential forces at their contacts. The normal force is perpendicular to the contact surface and acts to compress the particles, while the tangential force is parallel to the contact surface and acts to shear the particles. The friction coefficient and rolling resistance coefficient govern the resistance to sliding and rolling at the contacts, respectively.

The specific values of these parameters will depend on the material being studied and the experimental setup. Calibrating these parameters using experimental data is an important step in obtaining accurate simulation results.

**Shah Nawaz**: what are dimensionless parameteres

**Raycast AI:** Dimensionless parameters are quantities that are formed by combining physical parameters in a way that eliminates the units of measurement. They are useful in many fields of science and engineering, including fluid mechanics, heat transfer, and solid mechanics. Dimensionless parameters provide a way to compare the behavior of different systems or processes, regardless of their size or the units used to measure them.

Some common dimensionless parameters include:

1. Reynolds number (Re): This parameter is used in fluid mechanics to describe the relative importance of inertial forces to viscous forces. It is defined as the ratio of inertial forces to viscous forces and is given by Re = ρVD/μ, where ρ is the density of the fluid, V is the characteristic velocity, D is the characteristic length scale, and μ is the dynamic viscosity of the fluid.

2. Froude number (Fr): This parameter is used in fluid mechanics to describe the relative importance of inertial forces to gravitational forces. It is defined as the ratio of the characteristic velocity to the square root of the product of the characteristic length scale and the gravitational acceleration, and is given by Fr = V/√(gD), where g is the gravitational acceleration.

3. Mach number (Ma): This parameter is used in compressible flow to describe the relative importance of compressibility effects. It is defined as the ratio of the characteristic velocity to the speed of sound, and is given by Ma = V/a, where a is the speed of sound.

4. Strouhal number (St): This parameter is used to describe the unsteady behavior of fluid flows. It is defined as the ratio of the characteristic frequency to the product of the characteristic length scale and the characteristic velocity, and is given by St = fD/V, where f is the characteristic frequency.

5. Euler number (Eu): This parameter is used in solid mechanics to describe the relative importance of compressibility effects. It is defined as the ratio of the hydrostatic stress to the bulk modulus of the material, and is given by Eu = σ/κ, where σ is the hydrostatic stress and κ is the bulk modulus.

Dimensionless parameters are often used in simulations and experiments to simplify the analysis and interpretation of the results. They can also be used to design and optimize systems or processes by identifying the key physical parameters that govern their behavior.

**Shah Nawaz**: and in case of dem

**Raycast AI:** In the context of Discrete Element Method (DEM), there are several dimensionless parameters that are commonly used to describe the behavior of granular materials. These include:

1. Particle Reynolds number (Re_p): This parameter is used to describe the relative importance of inertial forces to viscous forces at the particle scale. It is defined as the ratio of the particle velocity to the fluid viscosity times the particle radius, and is given by Re_p = ρ_f V_p d_p / μ_f, where ρ_f is the fluid density, V_p is the particle velocity, d_p is the particle diameter, and μ_f is the fluid viscosity.

2. Coordination number (Z): This parameter is used to describe the average number of contacts per particle in a granular material. It is defined as the ratio of the total number of contacts to the number of particles, and is given by Z = 2N_c / N_p, where N_c is the total number of contacts and N_p is the number of particles.

3. Packing fraction (ϕ): This parameter is used to describe the volume fraction of particles in a granular material. It is defined as the ratio of the volume occupied by the particles to the total volume, and is given by ϕ = V_p / V_t, where V_p is the volume of the particles and V_t is the total volume.

4. Normal stiffness ratio (k_n^*): This parameter is used to describe the relative importance of normal forces to tangential forces at the particle contacts. It is defined as the ratio of the normal stiffness to the tangential stiffness, and is given by k_n^* = k_n / k_t, where k_n is the normal stiffness and k_t is the tangential stiffness.

5. Inertial number (I): This parameter is used to describe the relative importance of inertial forces to gravitational forces in a granular material. It is defined as the ratio of the characteristic particle velocity to the square root of the product of the gravitational acceleration and the characteristic particle diameter, and is given by I = V_p / √(gd_p), where g is the gravitational acceleration.

These dimensionless parameters are useful for characterizing the behavior of granular materials in a way that is independent of the specific size or units used to measure the system. They can be used to compare different granular materials or to study the effects of changing input parameters on the behavior of a specific material.

**Shah Nawaz**: any other dimensionless parametres for dem in granular materials

**Raycast AI:** Yes, there are several other dimensionless parameters that are commonly used in Discrete Element Method (DEM) simulations of granular materials. Some additional examples include:

1. Shear modulus ratio (G^*): This parameter is used to describe the relative importance of shear forces to normal forces at the particle contacts. It is defined as the ratio of the shear modulus to the normal modulus, and is given by G^* = G / k_n, where G is the shear modulus and k_n is the normal stiffness.

2. Péclet number (Pe): This parameter is used to describe the relative importance of advection to diffusion in a granular material. It is defined as the ratio of the characteristic advection velocity to the characteristic diffusion coefficient, and is given by Pe = V_p L / D, where L is the characteristic length scale and D is the diffusion coefficient.

3. Frictional force ratio (f_f): This parameter is used to describe the relative importance of frictional forces to normal forces at the particle contacts. It is defined as the ratio of the frictional force to the normal force, and is given by f_f = F_t / F_n, where F_t is the tangential force and F_n is the normal force.

4. Bond number (Bo): This parameter is used to describe the relative importance of surface tension to gravity in a granular material. It is defined as the ratio of the characteristic surface tension force to the gravitational force, and is given by Bo = γ L^2 / (ρ_p g d_p^3), where γ is the surface tension, ρ_p is the particle density, and g is the gravitational acceleration.

5. Contact number (N_c): This parameter is used to describe the total number of contacts between particles in a granular material. It is defined as the number of contacts per particle, and is given by N_c = Z N_p / 2, where Z is the coordination number and N_p is the number of particles.

These dimensionless parameters can be useful for understanding the behavior of granular materials under different conditions and for comparing the behavior of different materials. However, the specific parameters that are relevant will depend on the specific system being studied and the questions being asked.

**Shah Nawaz**: show all dimensionless parametres for dem of granular materials with equations

**Raycast AI:** Here are some of the most commonly used dimensionless parameters for Discrete Element Method (DEM) simulations of granular materials, along with their equations:

1. Reynolds number (Re): This parameter is used to describe the relative importance of inertial forces to viscous forces in the fluid phase surrounding the particles. It is defined as the ratio of the inertial forces to the viscous forces and is given by Re = ρ_f V_p d_p / μ_f, where ρ_f is the fluid density, V_p is the characteristic particle velocity, d_p is the characteristic particle diameter, and μ_f is the fluid viscosity.

2. Péclet number (Pe): This parameter is used to describe the relative importance of advection to diffusion in a granular material. It is defined as the ratio of the characteristic advection velocity to the characteristic diffusion coefficient and is given by Pe = V_p L / D, where L is the characteristic length scale and D is the diffusion coefficient.

3. Inertial number (I): This parameter is used to describe the relative importance of inertial forces to gravitational forces in a granular material. It is defined as the ratio of the characteristic particle velocity to the square root of the product of the gravitational acceleration and the characteristic particle diameter and is given by I = V_p / √(gd_p), where g is the gravitational acceleration.

4. Shear modulus ratio (G^*): This parameter is used to describe the relative importance of shear forces to normal forces at the particle contacts. It is defined as the ratio of the shear modulus to the normal modulus and is given by G^* = G / k_n, where G is the shear modulus and k_n is the normal stiffness.

5. Coordination number (Z): This parameter is used to describe the average number of contacts per particle in a granular material. It is defined as the ratio of the total number of contacts to the number of particles and is given by Z = 2N_c / N_p, where N_c is the total number of contacts and N_p is the number of particles.

6. Packing fraction (ϕ): This parameter is used to describe the volume fraction of particles in a granular material. It is defined as the ratio of the volume occupied by the particles to the total volume and is given by ϕ = V_p / V_t, where V_p is the volume of the particles and V_t is the total volume.

7. Bond number (Bo): This parameter is used to describe the relative importance of surface tension to gravity in a granular material. It is defined as the ratio of the characteristic surface tension force to the gravitational force and is given by Bo = γ L^2 / (ρ_p g d_p^3), where γ is the surface tension, ρ_p is the particle density, and g is the gravitational acceleration.

8. Frictional force ratio (f_f): This parameter is used to describe the relative importance of frictional forces to normal forces at the particle contacts. It is defined as the ratio of the frictional force to the normal force and is given by f_f = F_t / F_n, where F_t is the tangential force and F_n is the normal force.

These dimensionless parameters can be used to compare the behavior of different granular materials or to study the effects of changing input parameters on the behavior of a specific material. The specific values of these parameters will depend on the material being studied and the experimental setup.

**Shah Nawaz**: what about rolling resistance as dimensionless parameter 

**Raycast AI:** Rolling resistance is not typically expressed as a dimensionless parameter in Discrete Element Method (DEM) simulations of granular materials. Instead, rolling resistance is usually represented as a contact parameter that depends on the material properties of the particles and the nature of the contact between them.

In DEM simulations, rolling resistance is often modeled using a rolling resistance coefficient (RRC), which is a measure of the resistance to rolling at the contact between two particles. The RRC is typically defined as the ratio of the rolling torque to the normal force at the contact and is given by RRC = T_r / F_n, where T_r is the rolling torque and F_n is the normal force.

The rolling resistance coefficient can be calibrated using experimental data or estimated based on theoretical models. The value of the RRC depends on the material properties of the particles, such as their shape, size, and surface roughness, as well as the nature of the contact between them, such as the angle of contact and the interparticle forces.

While rolling resistance is an important factor in the behavior of granular materials, it is not typically expressed as a dimensionless parameter in DEM simulations. Instead, it is represented as a contact parameter that is calibrated or estimated based on experimental or theoretical data.

**Shah Nawaz**: what happens when we add rolling resistance to dem for granular materials

**Raycast AI:** When rolling resistance is added to Discrete Element Method (DEM) simulations of granular materials, it can have a significant effect on the behavior of the material. Rolling resistance is the resistance to rolling at the contact between two particles, and it arises due to the deformation and rotation of the particles during contact.

In DEM simulations, rolling resistance is typically modeled using a rolling resistance coefficient (RRC), which is a measure of the resistance to rolling at the contact between two particles. When the RRC is non-zero, the tangential force at each contact is modified to include a rolling resistance term, which can affect the overall behavior of the material.

The addition of rolling resistance to DEM simulations can lead to several changes in the behavior of the granular material, including:

1. Increased shear strength: Rolling resistance can increase the resistance to shear deformation in the material, leading to higher shear strengths and more stable structures.

2. Enhanced segregation: The presence of rolling resistance can lead to enhanced segregation of particles based on their size and shape, as particles with different rolling resistances will tend to separate from each other.

3. Reduced mobility: Rolling resistance can reduce the mobility of particles in the material, making it more difficult for them to move or flow under external forces.

4. Increased energy dissipation: Rolling resistance can increase the amount of energy dissipated during collisions between particles, leading to more efficient energy transfer and reduced particle velocities.

Overall, the addition of rolling resistance to DEM simulations of granular materials can provide a more realistic representation of the behavior of the material, particularly in situations where rolling effects are important. However, it can also increase the computational complexity of the simulation and require additional calibration of the rolling resistance coefficient based on experimental or theoretical data.

**Shah Nawaz**: what is sliding resistance in discrete element modelling

**Raycast AI:** Sliding resistance in discrete element modelling refers to the force that opposes the relative motion between two contacting particles in a simulation. It is a key parameter that affects the overall behavior of the system, and is typically modeled using frictional contact laws that take into account the properties of the particles and the contact surfaces.

**Shah Nawaz**: how this parameter evolves in dem for granular materials

**Raycast AI:** In DEM simulations of granular materials, the sliding resistance parameter typically evolves over time as a result of particle rearrangements and changes in the contact network. As particles move and interact with each other, the contact forces between them can cause the sliding resistance to increase or decrease, depending on factors such as particle size, shape, and surface properties. Additionally, the sliding resistance can be affected by external factors such as applied loads or changes in the boundary conditions of the simulation. As a result, the evolution of the sliding resistance is an important aspect of understanding the behavior of granular materials in DEM simulations.

**Shah Nawaz**: show with equations

**Raycast AI:** The sliding resistance in DEM is typically modeled using a frictional contact law that relates the contact force between two particles to the normal force and the coefficient of friction. One common model is the linear-spring dashpot model, which assumes that the contact force F is proportional to the overlap δ between the particles and the normal force N:

```
F = -kδ - γv

```

where k is the stiffness of the spring, γ is the damping coefficient of the dashpot, and v is the relative velocity between the particles.

The sliding resistance can then be calculated as the maximum force that can be transmitted between the particles before sliding occurs:

```
F_max = μN

```

where μ is the coefficient of friction between the particles.

The evolution of the sliding resistance depends on the values of k, γ, and μ, which can be adjusted to simulate different materials and conditions. In addition, the sliding resistance can change over time as a result of particle rearrangements and changes in the contact network, which can affect the values of δ, N, and v in the contact law.

**Shah Nawaz**: how we can measure sliding resistance when we have data from a dem experiment with normal and tangential forces as well diameters of all grains at multiple time steps

**Raycast AI:** To measure the sliding resistance in a DEM experiment using normal and tangential forces as well as diameters of all grains at multiple time steps, one approach is to analyze the contact forces between particles and calculate the coefficient of friction at each contact. This can be done using the following steps:

1. Identify all contacts between particles at each time step based on their overlap and distance.

2. Calculate the normal force N and tangential force T at each contact using the normal and tangential components of the contact force.

3. Calculate the coefficient of friction μ for each contact as the ratio of the tangential force to the normal force:

```
μ = |T| / N
```

4. Average the values of μ over all contacts at each time step to obtain a time series of the sliding resistance.

Note that the sliding resistance may vary spatially within the system, so it may be necessary to analyze the data for different regions or subgroups of particles. In addition, the choice of contact force model and parameters can affect the accuracy of the results, so it is important to validate the measurements against known values or experimental data if possible.

**Shah Nawaz**: what is relation between sliding and rolling resistance in dem

**Raycast AI:** In DEM simulations, sliding and rolling resistance are two distinct forms of resistance that arise from the interactions between particles. Sliding resistance refers to the force that opposes the relative motion between two contacting particles, while rolling resistance refers to the torque that opposes the rotation of a particle about its center of mass.

The relationship between sliding and rolling resistance depends on the properties of the particles and the contact surfaces. In general, particles that have a high coefficient of friction tend to experience more sliding resistance and less rolling resistance, while particles that have a low coefficient of friction tend to experience more rolling resistance and less sliding resistance.

However, it is important to note that sliding and rolling resistance can both occur simultaneously in many cases, and their relative contributions to the overall resistance of the system can vary depending on factors such as the particle size distribution, packing density, and external loading conditions. In addition, the choice of contact force model and parameters can affect the balance between sliding and rolling resistance in a DEM simulation.

**Shah Nawaz**: show with equations 

**Raycast AI:** The sliding and rolling resistance in DEM simulations can be modeled using contact force laws that take into account the properties of the particles and the contact surfaces. One common model is the linear-spring dashpot model, which assumes that the contact force F between two particles is proportional to the overlap δ between the particles and the normal force N:

```
F = -kδ - γv

```

where k is the stiffness of the spring, γ is the damping coefficient of the dashpot, and v is the relative velocity between the particles.

The sliding resistance can then be calculated as the maximum force that can be transmitted between the particles before sliding occurs:

```
F_max_sliding = μ_s N

```

where μ_s is the coefficient of sliding friction between the particles.

The rolling resistance can be modeled using a similar approach, but with a different contact force law that takes into account the torque τ that opposes the rotation of a particle about its center of mass:

```
τ = -k_rolling φ - γ_rolling ω

```

where k_rolling is the stiffness of the rolling spring, φ is the angular overlap between the particles, γ_rolling is the damping coefficient of the rolling dashpot, and ω is the angular velocity of the particle.

The rolling resistance can then be calculated as the maximum torque that can be transmitted between the particles before rolling occurs:

```
τ_max_rolling = μ_rolling N d/2

```

where μ_rolling is the coefficient of rolling friction between the particles, and d is the diameter of the particle.

Note that the balance between sliding and rolling resistance depends on the values of μ_s and μ_rolling, as well as the particle properties and external loading conditions. In general, particles that have a high coefficient of sliding friction and a low coefficient of rolling friction tend to experience more sliding resistance and less rolling resistance, while particles that have a low coefficient of sliding friction and a high coefficient of rolling friction tend to experience more rolling resistance and less sliding resistance.

**Shah Nawaz**: what does it mean rolling resiatance in case of a dem experiment with 3d spherical particles

**Raycast AI:** In a DEM experiment with 3D spherical particles, rolling resistance refers to the torque that opposes the rotation of a particle about its center of mass when it comes into contact with other particles or surfaces. Rolling resistance arises from the deformation of the particles and the frictional forces that act between them, and can play an important role in determining the overall behavior of the system.

In the context of 3D spherical particles, rolling resistance can be quantified using the coefficient of rolling friction μ_rolling, which describes the resistance to rolling motion between two contacting particles. The value of μ_rolling depends on the properties of the particles and the contact surfaces, and can be determined experimentally or estimated using theoretical models.

In a DEM simulation of 3D spherical particles, rolling resistance is typically modeled using a contact force law that takes into account the torque τ that opposes the rotation of a particle about its center of mass:

```
τ = -k_rolling φ - γ_rolling ω

```

where k_rolling is the stiffness of the rolling spring, φ is the angular overlap between the particles, γ_rolling is the damping coefficient of the rolling dashpot, and ω is the angular velocity of the particle.

The maximum torque that can be transmitted between two contacting particles before rolling occurs is given by:

```
τ_max_rolling = μ_rolling N d/2

```

where N is the normal force between the particles, d is the diameter of the particle, and μ_rolling is the coefficient of rolling friction.

Overall, rolling resistance is an important aspect of understanding the behavior of 3D spherical particles in DEM simulations, and can affect a wide range of phenomena such as packing density, stress distribution, and particle segregation.

**Shah Nawaz**: what is role of time step in dem

**Raycast AI:** In DEM simulations, the time step plays a critical role in determining the accuracy and stability of the simulation. The time step is the interval at which the simulation advances from one state to the next, and is typically chosen based on the physical properties of the system and the numerical methods used to solve the equations of motion.

The time step must be small enough to capture the relevant dynamics of the system, but not so small that the simulation becomes computationally expensive or unstable. If the time step is too large, the simulation may miss important events or produce inaccurate results due to numerical errors. On the other hand, if the time step is too small, the simulation may become prohibitively slow or suffer from numerical instability due to round-off errors or other numerical effects.

The choice of time step depends on several factors, including the particle size, velocity, and acceleration, as well as the stiffness and damping of the contact forces. In general, smaller particles and higher contact stiffness and damping require smaller time steps to accurately capture the dynamics of the system. Additionally, the choice of numerical integration method can affect the stability and accuracy of the simulation, and may require different time steps depending on the method used.

Overall, the time step is a critical parameter in DEM simulations that affects the accuracy, stability, and computational efficiency of the simulation, and must be carefully chosen based on the properties of the system and the numerical methods used.

**Shah Nawaz**: show with equations

**Raycast AI:** The role of the time step in DEM simulations can be understood by considering the equations of motion that govern the behavior of the particles. In a typical DEM simulation, the equations of motion for a particle can be written as:

```
m_i * a_i = F_i^c + F_i^d + F_i^e + F_i^g
```

where m_i is the mass of particle i, a_i is its acceleration, F_i^c is the contact force between particle i and its neighbors, F_i^d is the damping force due to viscous or other dissipation effects, F_i^e is any external force applied to the particle, and F_i^g is the gravitational force acting on the particle.

The contact force F_i^c depends on the overlap and relative velocity between the particles, and is typically modeled using a contact force law such as the linear-spring dashpot model:

```
$$
F_ij^c = -k_ij * δ_ij - γ_ij * v_ij
$$
```

where k_ij is the stiffness of the contact spring, δ_ij is the overlap between particles i and j, γ_ij is the damping coefficient of the contact dashpot, and v_ij is the relative velocity between particles i and j.

The time step Δt is the interval at which the simulation advances from one state to the next, and is typically chosen based on the stability and accuracy requirements of the simulation. The time step affects the accuracy of the simulation because it determines how accurately the dynamics of the system are captured. The time step also affects the stability of the simulation because it determines how well the simulation can handle the numerical errors that arise from approximating the continuous equations of motion with discrete time steps.

The time step is typically chosen based on the properties of the system and the numerical methods used. In general, the time step should be small enough to accurately capture the dynamics of the system, but not so small that the simulation becomes computationally expensive or unstable. The time step can be estimated using the Courant-Friedrichs-Lewy (CFL) condition, which states that the time step should be no larger than a certain fraction of the smallest characteristic length scale and time scale in the system:

```
Δt ≤ CFL * min(δ_ij / v_ij, (m_i / k_ij)^0.5)
```

where CFL is a dimensionless constant that depends on the numerical integration method used, and δ_ij and v_ij are the overlap and relative velocity between particles i and j.

Overall, the choice of time step is an important aspect of DEM simulations that affects the accuracy, stability, and computational efficiency of the simulation, and must be carefully chosen based on the properties of the system and the numerical methods used.

**Shah Nawaz** what is a boundary condition in discrete element method

Raycast AI: In the discrete element method (DEM), a boundary condition is a set of constraints that define how particles interact with the boundaries of a simulation domain. These conditions can include fixed walls, moving walls, periodic boundaries, and more complex conditions that simulate specific physical phenomena. Boundary conditions are important in DEM simulations because they can significantly affect the behavior of particles and the accuracy of the results.

**Shah Nawaz** explain each boundary condition in detail

Raycast AI: Sure, here's a brief explanation of each boundary condition used in the discrete element method (DEM):

1. Fixed walls: Fixed walls are boundaries that are stationary and do not move during the simulation. They are commonly used to simulate the effects of rigid walls in a physical system. When a particle collides with a fixed wall, its velocity is reversed to simulate a bounce.

2. Moving walls: Moving walls are boundaries that move during the simulation. They can be used to simulate systems where the boundaries are in motion, such as conveyor belts or vibrating plates. When a particle collides with a moving wall, its velocity is reversed and updated based on the velocity of the wall.

3. Periodic boundaries: Periodic boundaries are boundaries that wrap around the simulation domain, creating a toroidal space. Particles that exit one side of the domain re-enter from the opposite side. Periodic boundaries are useful for simulating systems that exhibit periodic behavior, such as crystals or fluids.

4. Absorbing boundaries: Absorbing boundaries are boundaries that absorb particles that collide with them. They are commonly used to simulate the effects of soft walls in a physical system, such as a deformable membrane. When a particle collides with an absorbing boundary, it is removed from the simulation.

5. Frictional boundaries: Frictional boundaries are boundaries that apply a frictional force to particles that collide with them. They are commonly used to simulate the effects of rough or textured walls in a physical system. The frictional force is proportional to the normal force between the particle and the boundary.

6. Coupled boundaries: Coupled boundaries are boundaries that are connected to other parts of the simulation, such as a fluid or an external force. They are commonly used to simulate systems where the boundaries are not completely isolated, such as a particle-laden fluid flowing through a pipe.

These are some of the most common boundary conditions used in DEM simulations, but there are many others that can be used depending on the specific needs of the simulation.

**Shah Nawaz** is there any equation or mathematical for these boundary conditions

Raycast AI: Yes, each boundary condition in the discrete element method (DEM) can be described mathematically using different equations. Here are some examples:

1. Fixed walls: When a particle collides with a fixed wall, its velocity is reversed to simulate a bounce. This can be described using the following equation:

   v' = -e*v

   where v is the velocity vector of the particle before the collision, v' is the velocity vector after the collision, and e is the coefficient of restitution, which represents the ratio of the velocity of separation to the velocity of approach.

2. Moving walls: When a particle collides with a moving wall, its velocity is reversed and updated based on the velocity of the wall. This can be described using the following equation:

   v' = -e*(v - u) + u

   where v is the velocity vector of the particle before the collision, v' is the velocity vector after the collision, u is the velocity vector of the moving wall, and e is the coefficient of restitution.

3. Periodic boundaries: Periodic boundaries wrap around the simulation domain, creating a toroidal space. Particles that exit one side of the domain re-enter from the opposite side. This can be described using the following equation:

   x' = x + L

   where x is the position vector of the particle before it exits the domain, x' is the position vector after it re-enters the domain, and L is the length of the simulation domain in the direction of the periodic boundary.

4. Absorbing boundaries: When a particle collides with an absorbing boundary, it is removed from the simulation. This can be described using the following equation:

   Remove particle i

   where i is the index of the particle that collides with the absorbing boundary.

5. Frictional boundaries: Frictional boundaries apply a frictional force to particles that collide with them. This can be described using the following equation:

   F_friction = -mu*F_normal*v

   where F_friction is the frictional force, mu is the coefficient of friction, F_normal is the normal force between the particle and the boundary, and v is the relative velocity between the particle and the boundary.

6. Coupled boundaries: Coupled boundaries are connected to other parts of the simulation, such as a fluid or an external force. The equations used to describe these boundaries depend on the specific coupling method used in the simulation. For example, in a fluid-particle simulation, the fluid forces acting on the boundary can be calculated using the Navier-Stokes equations, while the forces acting on the particles can be calculated using the equations of motion for discrete particles.

These are just a few examples of the equations used to describe the different boundary conditions in DEM simulations. The specific equations used can vary depending on the details of the simulation and the specific needs of the researcher.

**Shah Nawaz** what type of analysis we can do from output of a dem simulation with shear test of granular materials in a rigid box with a moveable plate underneath such that it produces cyclic shear. The data includes 3 normal vectors, two normal and tangential forces at the end of each cycle. dia of 20000 polydisperse grains. we have positions of all grains at end of each cycle as well as a list of particle at end of each cycle. Suggest common analysis for this type of modified direct shear dem test 

Raycast AI: The output of a DEM simulation with a shear test of granular materials can provide a wealth of information about the behavior of the system. Here are some common analyses that can be performed using the data you have described:

1. Shear stress-strain curves: The normal and tangential forces at the end of each cycle can be used to calculate the shear stress and strain in the system. Plotting the shear stress versus the shear strain can provide insight into the mechanical behavior of the granular material, such as its strength, stiffness, and deformation characteristics.

2. Particle-scale analysis: The positions of all grains at the end of each cycle can be used to analyze the behavior of individual particles and their interactions with each other. This can include calculating the local packing density, identifying force chains, and measuring particle displacements and rotations.

3. Particle size distribution: The diameter of the 20,000 polydisperse grains can be used to calculate the particle size distribution in the system. This information can be used to analyze the effect of particle size on the mechanical behavior of the granular material.

4. Contact network analysis: The list of particles at the end of each cycle can be used to construct a contact network, which describes the contacts between particles in the system. Analyzing the contact network can provide insight into the structure and connectivity of the granular material, as well as its response to external forces.

5. Energy analysis: The work done by the plate during each cycle can be used to calculate the energy input into the system. This information can be used to analyze the energy dissipation and the efficiency of the shear test.

These are just a few examples of the types of analyses that can be performed using the output of a modified direct shear DEM test. The specific analyses that are most appropriate for your data will depend on your research questions and the details of the simulation.

**Shah Nawaz** suggest equations to plot graphs for shear stress strain graphs such that plate is moving in cycle forward and backward

Raycast AI: To plot shear stress-strain graphs for a cyclic shear test in a DEM simulation, you can use the following equations:

1. Shear strain:

   gamma = (delta_x - delta_x0) / h

   where delta_x is the displacement of the plate, delta_x0 is the initial displacement of the plate, and h is the height of the granular material.

2. Shear stress:

   tau = F_t / A

   where F_t is the tangential force on the plate, and A is the area of the plate.

To plot the shear stress-strain curve for a cyclic shear test, you can perform the following steps:

1. Calculate the shear strain for each cycle of the shear test using the equation above.

2. Calculate the maximum and minimum shear strain for each cycle, as well as the average shear strain.

3. Calculate the maximum and minimum shear stress for each cycle using the equation above.

4. Plot the shear stress versus the average shear strain for each cycle, using a line graph or scatter plot.

5. Add error bars to the plot to indicate the range of shear strain and shear stress for each cycle.

6. Calculate the mean and standard deviation of the shear stress at each shear strain level, and plot these values as a separate graph.

7. Optionally, you can also plot the shear stress versus the maximum and minimum shear strain for each cycle to show the cyclic nature of the test.

These equations and steps can be modified as per the specific requirements of your simulation and research question.

**Shah Nawaz** suggest equations to plot graphs for particle scale graphs such that plate is moving in cycle forward and backward

Raycast AI: To plot particle-scale graphs for a cyclic shear test in a DEM simulation, you can use the following equations:

1. Particle displacement:

   delta_r = r - r0

   where r is the position vector of the particle at the end of the cycle, and r0 is the position vector of the particle at the beginning of the cycle.

2. Particle rotation:

   delta_theta = acos((R - R0) / 2)

   where R is the rotation matrix of the particle at the end of the cycle, and R0 is the rotation matrix of the particle at the beginning of the cycle.

3. Contact force:

   F_contact = -k_n * delta_r_n - k_t * delta_r_t

   where k_n and k_t are the normal and tangential spring constants, and delta_r_n and delta_r_t are the normal and tangential components of the particle displacement.

To plot particle-scale graphs for a cyclic shear test, you can perform the following steps:

1. Calculate the particle displacement and rotation for each particle at the end of each cycle using the equations above.

2. Plot the particle displacement and rotation as vectors or arrows on a 2D or 3D plot, with the length and direction of the vector indicating the magnitude and direction of the displacement or rotation.

3. Color code the vectors or arrows based on the magnitude or direction of the displacement or rotation to highlight any patterns or trends in the data.

4. Calculate the contact force for each particle at the end of each cycle using the equation above.

5. Plot the contact force as a vector or arrow on the same plot as the particle displacement and rotation, with the length and direction of the vector indicating the magnitude and direction of the contact force.

6. Color code the contact force vectors or arrows based on the magnitude or direction of the force to highlight any patterns or trends in the data.

These equations and steps can be modified as per the specific requirements of your simulation and research question.

**Shah Nawaz** how rotation matrix is calculated

Raycast AI: In a DEM simulation, the rotation matrix is used to represent the orientation of a particle in 3D space. The rotation matrix is a 3x3 matrix that describes the rotation of a particle relative to its initial orientation. The rotation matrix can be calculated using the following steps:

1. Calculate the rotation angle and axis:

   theta = ||delta_r|| / r

   axis = delta_r / ||delta_r||

   where delta_r is the displacement vector of the particle, r is the initial position of the particle, ||delta_r|| is the magnitude of the displacement vector, theta is the rotation angle, and axis is the rotation axis.

2. Construct the rotation matrix:

   Let u, v, and w be the unit vectors along the x, y, and z axes, respectively.

   u' = u cos(theta) + (v x axis) sin(theta) + axis (axis . u)(1 - cos(theta))

   v' = v cos(theta) + (axis x u) sin(theta) + axis (axis . v)(1 - cos(theta))

   w' = w cos(theta) + axis x w sin(theta) + axis (axis . w)(1 - cos(theta))

   where x represents the cross product, . represents the dot product, and u', v', and w' are the unit vectors along the x', y', and z' axes, respectively, after the rotation.

3. Construct the rotation matrix:

   R = [u' v' w']

   where R is the 3x3 rotation matrix.

This rotation matrix can then be used to transform the position and orientation of the particle in subsequent time steps. Note that this method assumes small rotations, and may not be accurate for large rotations. In such cases, more advanced methods such as quaternions may be used to represent the particle orientation.

**Shah Nawaz** suggest equations to plot graphs for particle size distribution graphs such that plate is moving in cycle forward and backward and we have coordiantes of lower plate and surrounding walls at the end of each cycle

Raycast AI: To plot particle size distribution graphs for a cyclic shear test in a DEM simulation, you can use the following equations:

1. Calculate the diameter of each particle at the end of each cycle using the particle position data.

2. Bin the particle diameters into size classes, such as every 0.1 mm or every 10 pixels.

3. Calculate the number of particles in each size class at the end of each cycle.

4. Normalize the particle count in each size class by the total number of particles in the system to obtain the particle size distribution.

To plot particle size distribution graphs for a cyclic shear test, you can perform the following steps:

1. For each cycle of the shear test, calculate the particle size distribution using the equations above.

2. Plot the particle size distribution as a histogram or bar chart, with the size classes on the x-axis and the normalized particle count on the y-axis.

3. Color code the bars or histogram bins based on the cycle number to show the evolution of the particle size distribution over time.

4. Optionally, you can also plot the cumulative particle size distribution as a line graph, with the particle diameter on the x-axis and the cumulative particle count on the y-axis. This can provide additional information about the particle size distribution and its evolution over time.

To incorporate the coordinates of the lower plate and surrounding walls into the particle size distribution analysis, you can perform the following additional steps:

1. Use the coordinates of the lower plate and surrounding walls to define the boundaries of the system.

2. Exclude particles that are in contact with the boundaries from the particle size distribution analysis, as they may be affected by the boundary conditions.

3. Optionally, you can also plot the particle size distribution separately for different regions of the system, such as the center and edges, to analyze any spatial variations in the particle size distribution.

These equations and steps can be modified as per the specific requirements of your simulation and research question.

**Shah Nawaz** suggest equations to plot graphs for contact network graphs such that plate is moving in cycle forward and backward and we have coordiantes of lower plate and surrounding walls at the end of each cycle

Raycast AI: To plot contact network graphs for a cyclic shear test in a DEM simulation, you can use the following equations:

1. Calculate the contact forces between particles at the end of each cycle using the particle position and force data.

2. Define a contact network as a graph, where each particle is a node and each contact between particles is an edge.

3. Assign a weight to each edge based on the magnitude of the contact force, such that stronger contacts have higher weights.

4. Optionally, you can also color code the nodes and edges based on their properties, such as the particle size or type, or the time step of the cycle.

To plot contact network graphs for a cyclic shear test, you can perform the following steps:

1. For each cycle of the shear test, calculate the contact network using the equations above.

2. Plot the contact network as a graph, with the nodes representing particles and the edges representing contacts between particles.

3. Assign a weight to each edge based on the magnitude of the contact force, such that stronger contacts have higher weights. You can use the thickness or color of the edges to represent the weight of the contacts.

4. Optionally, you can also color code the nodes and edges based on their properties, such as the particle size or type, or the time step of the cycle.

5. Analyze the contact network to identify any patterns or trends in the particle contacts and their properties, such as the connectivity of the network, the distribution of contact forces, or the evolution of the network over time.

To incorporate the coordinates of the lower plate and surrounding walls into the contact network analysis, you can perform the following additional steps:

1. Use the coordinates of the lower plate and surrounding walls to define the boundaries of the system.

2. Exclude contacts between particles and the boundaries from the contact network analysis, as they may be affected by the boundary conditions.

3. Optionally, you can also analyze the contact network separately for different regions of the system, such as the center and edges, to analyze any spatial variations in the particle contacts and their properties.

These equations and steps can be modified as per the specific requirements of your simulation and research question.

**Shah Nawaz** equations are not shown in your answer

Raycast AI: I apologize for the confusion. Here are the equations to plot contact network graphs for a cyclic shear test in a DEM simulation:

1. Calculate the contact forces between particles at the end of each cycle using the particle position and force data. Let F_ij be the contact force between particle i and particle j.

2. Define a contact network as a graph, where each particle is a node and each contact between particles is an edge.

3. Assign a weight to each edge based on the magnitude of the contact force, such that stronger contacts have higher weights. Let w_ij be the weight of the edge between particle i and particle j.

4. Optionally, you can also color code the nodes and edges based on their properties, such as the particle size or type, or the time step of the cycle.

To plot contact network graphs for a cyclic shear test, you can perform the following steps:

1. For each cycle of the shear test, calculate the contact network using the equations above.

2. Plot the contact network as a graph, with the nodes representing particles and the edges representing contacts between particles.

3. Assign a weight to each edge based on the magnitude of the contact force, such that stronger contacts have higher weights. You can use the thickness or color of the edges to represent the weight of the contacts.

4. Optionally, you can also color code the nodes and edges based on their properties, such as the particle size or type, or the time step of the cycle.

5. Analyze the contact network to identify any patterns or trends in the particle contacts and their properties, such as the connectivity of the network, the distribution of contact forces, or the evolution of the network over time.

To incorporate the coordinates of the lower plate and surrounding walls into the contact network analysis, you can perform the following additional steps:

1. Use the coordinates of the lower plate and surrounding walls to define the boundaries of the system.

2. Exclude contacts between particles and the boundaries from the contact network analysis, as they may be affected by the boundary conditions.

3. Optionally, you can analyze the contact network separately for different regions of the system, such as the center and edges, to analyze any spatial variations in the particle contacts and their properties.

Note that the specific equations used to calculate the contact forces and weights may depend on the contact model used in the DEM simulation, as well as the specific properties of the particles and their interactions. These equations can be modified as per the requirements of your simulation and research question.

**Shah Nawaz** suggest equations to plot graphs for energy analysis graphs such that plate is moving in cycle forward and backward

Raycast AI: To plot energy analysis graphs for a cyclic shear test in a DEM simulation, you can use the following equations:

1. Calculate the work done by the plate during each cycle using the displacement data. Let W_cycle be the work done by the plate during one cycle of the shear test.

2. Calculate the total energy input into the system during each cycle using the work-energy principle. Let E_cycle be the total energy input into the system during one cycle of the shear test.

   E_cycle = W_cycle + E_rest

   where E_rest is the potential energy of the system at rest, which can be calculated as the sum of the gravitational potential energy of each particle.

3. Optionally, you can also calculate the dissipated energy during each cycle using the difference between the total energy input and the energy stored in the system at the end of the cycle. Let E_diss be the dissipated energy during one cycle of the shear test.

   E_diss = E_cycle - E_end

   where E_end is the potential energy of the system at the end of the cycle, which can be calculated as the sum of the gravitational potential energy of each particle.

To plot energy analysis graphs for a cyclic shear test, you can perform the following steps:

1. For each cycle of the shear test, calculate the work done by the plate and the total energy input into the system using the equations above.

2. Plot the work done by the plate and the total energy input as line graphs or scatter plots, with the cycle number on the x-axis and the energy on the y-axis. You can use different colors or markers to distinguish between the work and energy curves.

3. Optionally, you can also plot the dissipated energy as a separate line graph or scatter plot to show the energy losses during the shear test.

4. Analyze the energy curves to identify any patterns or trends in the energy input and dissipation, such as the efficiency of the shear test, the effect of particle properties on the energy behavior, or the evolution of the energy over time.

These equations and steps can be modified as per the specific requirements of your simulation and research question.

**Shah Nawaz** i have given you the output data from dem simulation above from 20000 grains. such that we have velocities, positions, rotation velocities of all spheres at the end of each cycle. We also have position of each contact, normal vectors and forces in each contact as well . suggest work calculation for energy analysis 

Raycast AI: To calculate the work done by the plate and the total energy input into the system during a cyclic shear test using the output data from a DEM simulation, you can use the following equations:

1. Work done by the plate:

   The work done by the plate during a cycle can be calculated as the product of the tangential force and the displacement of the plate. Let F_t be the tangential force on the plate, and delta_x be the displacement of the plate.

   W_cycle = F_t * delta_x

2. Total energy input into the system:

   The total energy input into the system during a cycle can be calculated as the sum of the kinetic and potential energies of all particles in the system. Let m_i be the mass of particle i, v_i be the velocity of particle i, r_i be the position vector of particle i, and g be the gravitational acceleration.

   E_cycle = sum(0.5 * m_i * ||v_i||^2 + m_i * g . r_i)

   where ||v_i|| is the magnitude of the velocity vector, and g . r_i is the dot product of the gravitational acceleration and the position vector.

   Note that this equation assumes that the system is only subject to gravitational and contact forces, and does not account for any external forces or torques.

To calculate the work done by each contact and the dissipated energy during a cycle, you can use the following equations:

1. Work done by each contact:

   The work done by a contact during a cycle can be calculated as the product of the contact force and the displacement of the contact point. Let F_contact be the contact force, and delta_r be the displacement of the contact point.

   W_contact = F_contact . delta_r

2. Dissipated energy:

   The dissipated energy during a cycle can be calculated as the difference between the total energy input and the energy stored in the system at the end of the cycle. Let E_end be the potential energy of the system at the end of the cycle, which can be calculated using the equation for the total energy input above, and E_start be the potential energy of the system at the beginning of the cycle.

   E_diss = E_start - E_end - sum(W_contact)

   where sum(W_contact) is the sum of the work done by each contact during the cycle.

   Note that this equation assumes that the system is conservative, i.e., the total energy input is equal to the total energy output. If the system is non-conservative, such as when external forces or torques are applied, this equation may not be applicable.

To calculate the work done by the plate and the total energy input into the system for each cycle of the shear test, you can use the output data from the DEM simulation to compute the displacement and forces on the plate, as well as the positions, velocities, and forces on each particle. You can then use the equations above to calculate the work done by the plate, the total energy input into the system, and the dissipated energy for each cycle. These values can be plotted and analyzed to understand the energy behavior of the system during the shear test.

**Shah Nawaz** how dimensionless parameteres evolution can be studied in each cycle? is it a good idea?

Raycast AI: Studying the evolution of dimensionless parameters in each cycle of a DEM simulation can be a useful way to understand the behavior of the system and how it changes over time. Dimensionless parameters are quantities that are normalized by some characteristic length, time, or velocity scale, and are often used to compare different systems or to identify scaling laws.

To study the evolution of dimensionless parameters in each cycle of a DEM simulation, you can perform the following steps:

1. Identify the relevant dimensionless parameters for your system, based on the properties of the particles, the interactions between particles, and the boundary conditions. Examples of common dimensionless parameters in DEM simulations include the Reynolds number, the Froude number, the Peclet number, and the contact number.

2. Calculate the dimensionless parameters for each cycle of the shear test using the output data from the DEM simulation. This may involve normalizing the particle velocities, forces, or positions by some characteristic length, time, or velocity scale.

3. Plot the dimensionless parameters as line graphs or scatter plots, with the cycle number on the x-axis and the dimensionless parameter on the y-axis. You can use different colors or markers to distinguish between different dimensionless parameters.

4. Analyze the dimensionless parameter curves to identify any patterns or trends in the behavior of the system, such as the effect of particle properties or boundary conditions on the dimensionless parameters, or the evolution of the dimensionless parameters over time.

Studying the evolution of dimensionless parameters in each cycle of a DEM simulation can be a good idea if you are interested in understanding the scaling behavior of the system, or if you want to compare the behavior of different systems or conditions. However, it is important to choose the appropriate dimensionless parameters for your system and to interpret the results carefully, as the behavior of the system may depend on many factors beyond the dimensionless parameters alone.

**Shah Nawaz** how packing fraction can be calculated when we only know the position of the walls at the end of each cycle

Raycast AI: When you only know the position of the walls at the end of each cycle, you can estimate the packing fraction of the particles in the system using a method called "image analysis". This method involves analyzing the 2D or 3D images of the particle positions and using them to estimate the packing fraction.

To calculate the packing fraction using image analysis, you can perform the following steps:

1. Obtain the 2D or 3D images of the particle positions at the end of each cycle. This can be done using visualization software or by exporting the particle positions from the DEM simulation.

2. Segment the images to identify the particles and their boundaries. This can be done using image processing techniques such as thresholding, edge detection, or watershed segmentation.

3. Calculate the area or volume of each particle in the image using geometric measurements. For 2D images, the area can be calculated using the pixel size and the number of pixels in the particle. For 3D images, the volume can be calculated using the voxel size and the number of voxels in the particle.

4. Calculate the total area or volume of all particles in the image, and divide by the area or volume of the image to obtain the packing fraction.

   Packing fraction = Total particle area or volume / Image area or volume

   Note that the packing fraction calculated using this method may not be very accurate, as it depends on the resolution and quality of the images, as well as the accuracy of the particle segmentation and measurement. However, it can provide a rough estimate of the packing fraction and allow for comparisons between different cycles or systems.

Alternatively, if you know the size and shape of the particles in the system, you can estimate the packing fraction using analytical or numerical methods, such as the random close packing density or the sphere packing models. These methods may provide more accurate estimates of the packing fraction, but require additional information about the particles and their interactions.

**Shah Nawaz** we already have positions in 3d for each sphere

Raycast AI: If you already have the positions of all spheres in 3D, you can calculate the packing fraction of the system directly using the following equation:

Packing fraction = (Total volume of particles) / (Total volume of system)

To calculate the total volume of particles, you can sum the volumes of all spheres in the system:

Total volume of particles = sum(volume of each sphere)

To calculate the total volume of the system, you can use the dimensions of the simulation box or container. If the simulation box is rectangular, the total volume can be calculated as the product of the length, width, and height of the box:

Total volume of system = length x width x height

If the simulation box is cylindrical or spherical, the total volume can be calculated using the appropriate geometric formula.

Once you have calculated the packing fraction using this method, you can compare it between different cycles or systems to analyze the evolution of the packing fraction over time or to compare different simulation conditions. Note that the packing fraction is a key parameter that can affect the behavior of the system, such as the stress-strain response, the flow behavior, and the particle rearrangements. Therefore, it is important to monitor and analyze the packing fraction during the simulation to understand the behavior of the system.